(()=>{"use strict";var t=document.querySelector(".profile"),e=t.querySelector(".profile__edit-button"),n=t.querySelector(".profile__add-button"),r=t.querySelector(".profile__update-button"),o={inputSelector:".popup__input",inputErrorClass:"popup__input_type_error",errorSelector:".popup__error",errorClass:"popup__error_active",submitButtonSelector:".popup__submit-button",inactiveButtonClass:"popup__submit-button_disabled"},i={},u=Array.from(document.forms);function a(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var c=function(){function t(e,n){var r=e.items,o=e.render;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._items=r,this._renderer=o,this._container=document.querySelector(n)}var e,n;return e=t,(n=[{key:"renderItems",value:function(){var t=this;this._items.forEach((function(e){t._renderer(e)}))}},{key:"renderOneItem",value:function(t){this._renderer(t)}},{key:"addItem",value:function(t){this._container.prepend(t)}}])&&a(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function l(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var s=function(){function t(e,n){var r=e.data,o=e.handleCardClick,i=e.handleLikeClick,u=e.handleDeleteButtonClick;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._data=r,this._title=this._data.name,this._link=this._data.link,this._likes=this._data.likes.length,this._id=this._data._id,this._ownerId=this._data.owner._id,this._alt=this._title,this._handleCardClick=o,this._handleLikeClick=i,this._handleDeleteButtonClick=u,this._cardSelector=n}var e,n;return e=t,(n=[{key:"_getTemplate",value:function(){return document.querySelector(this._cardSelector).content.querySelector(".place").cloneNode(!0)}},{key:"_checkCard",value:function(t){t&&this._deleteButton.remove()}},{key:"_checkLike",value:function(t){t&&this.putLike()}},{key:"generateCard",value:function(t){this._element=this._getTemplate(),this._likeButton=this._element.querySelector(".place__like-button"),this._deleteButton=this._element.querySelector(".place__delete-button"),this._enlargeButton=this._element.querySelector(".place__enlarge-button"),this._cardLikes=this._element.querySelector(".place__like-counter");var e=this._element.querySelector(".place__title"),n=this._element.querySelector(".place__image");return e.textContent=this._title,n.src=this._link,n.alt=this._alt,this._cardLikes.textContent=this._likes,this._setEventListeners(),this._checkCard(t.isNotUserCard),this._checkLike(t.isLikedByUser),this._element}},{key:"_setEventListeners",value:function(){var t=this;this._likeButton.addEventListener("click",(function(){t._handleLikeClick()})),this._deleteButton&&this._deleteButton.addEventListener("click",(function(){t._handleDeleteButtonClick()})),this._enlargeButton.addEventListener("click",(function(){t._handleCardClick()}))}},{key:"deleteCard",value:function(){this._element.remove(),this._element=null}},{key:"putLike",value:function(){this._likeButton.classList.add("place__like-button_active")}},{key:"deleteLike",value:function(){this._likeButton.classList.remove("place__like-button_active")}},{key:"updateÐ¡ounter",value:function(t){this._cardLikes.textContent=t}}])&&l(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function f(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var p=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._popupSelector=e,this._popup=document.querySelector(this._popupSelector),this._openPopupSelector="popup_opened",this._handleEscClose=this._handleEscClose.bind(this)}var e,n;return e=t,(n=[{key:"_handleEscClose",value:function(t){"Escape"===t.key&&this.close()}},{key:"open",value:function(){document.addEventListener("keydown",this._handleEscClose),this._popup.classList.add(this._openPopupSelector)}},{key:"close",value:function(){document.removeEventListener("keydown",this._handleEscClose),this._popup.classList.remove(this._openPopupSelector)}},{key:"_handleClickClose",value:function(t){(t.target===t.currentTarget||t.target.classList.contains("popup__close-button"))&&this.close()}},{key:"setEventListeners",value:function(){var t=this;this._popup.addEventListener("click",(function(e){t._handleClickClose(e)}))}}])&&f(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function h(t){return h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},h(t)}function d(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function _(){return _="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=y(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},_.apply(this,arguments)}function y(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=m(t)););return t}function v(t,e){return v=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},v(t,e)}function b(t,e){if(e&&("object"===h(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function m(t){return m=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},m(t)}var k=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&v(t,e)}(u,t);var e,n,r,o,i=(r=u,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=m(r);if(o){var n=m(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return b(this,t)});function u(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,u),(e=i.call(this,t))._popupImage=e._popup.querySelector(".popup__image"),e._popupImageCaption=e._popup.querySelector(".popup__image-caption"),e}return e=u,(n=[{key:"open",value:function(t){this._popupImageCaption.textContent=t.name,this._popupImage.src=t.link,this._popupImage.alt=this._popupImageCaption.textContent,_(m(u.prototype),"open",this).call(this)}}])&&d(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),u}(p);function g(t){return g="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},g(t)}function E(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function w(){return w="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=S(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},w.apply(this,arguments)}function S(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=L(t)););return t}function C(t,e){return C=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},C(t,e)}function O(t,e){if(e&&("object"===g(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function L(t){return L=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},L(t)}var j=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&C(t,e)}(u,t);var e,n,r,o,i=(r=u,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=L(r);if(o){var n=L(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return O(this,t)});function u(t,e){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,u),(n=i.call(this,t))._handleSubmitForm=e,n._formElement=n._popup.querySelector(".popup__form"),n._inputList=n._formElement.querySelectorAll(".popup__input"),n._submitButtonElement=n._popup.querySelector(".popup__submit-button"),n}return e=u,(n=[{key:"close",value:function(){w(L(u.prototype),"close",this).call(this),this._formElement.reset()}},{key:"_getInputValues",value:function(){var t=this;return this._formValues={},this._inputList.forEach((function(e){t._formValues[e.name]=e.value})),this._formValues}},{key:"setEventListeners",value:function(){var t=this;w(L(u.prototype),"setEventListeners",this).call(this),this._formElement.addEventListener("submit",(function(e){e.preventDefault(),t._handleSubmitForm(t._getInputValues())}))}},{key:"getPopupForm",value:function(){return this._formElement}},{key:"setInputValues",value:function(t){this._inputList.forEach((function(e){e.value=t[e.name]}))}},{key:"getSubmitButton",value:function(){return this._submitButtonElement}}])&&E(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),u}(p);function P(t){return P="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},P(t)}function B(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function I(){return I="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=R(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},I.apply(this,arguments)}function R(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=x(t)););return t}function T(t,e){return T=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},T(t,e)}function q(t,e){if(e&&("object"===P(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function x(t){return x=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},x(t)}var U=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&T(t,e)}(u,t);var e,n,r,o,i=(r=u,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=x(r);if(o){var n=x(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return q(this,t)});function u(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,u),(e=i.call(this,t))._handleClickSubmit={},e._submitButtonElement=e._popup.querySelector(".popup__submit-button"),e}return e=u,(n=[{key:"setHandler",value:function(t){this._handleClickSubmit=t}},{key:"setEventListeners",value:function(){var t=this;I(x(u.prototype),"setEventListeners",this).call(this),this._submitButtonElement.addEventListener("click",(function(){t._handleClickSubmit()}))}},{key:"getSubmitButton",value:function(){return this._submitButtonElement}}])&&B(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),u}(p);function A(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var D=function(){function t(e){var n=e.nameSelector,r=e.aboutSelector,o=e.avatarSelector;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._name=document.querySelector(n),this._about=document.querySelector(r),this._avatar=document.querySelector(o)}var e,n;return e=t,(n=[{key:"getUserInfo",value:function(){return{name:this._name.textContent,about:this._about.textContent,avatar:this._avatar.src}}},{key:"setUserInfo",value:function(t){this._name.textContent=t.name,this._about.textContent=t.about,this._avatar.src=t.avatar}}])&&A(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function V(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var N=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._inputSelector=e.inputSelector,this._inputErrorClass=e.inputErrorClass,this._errorSelector=e.errorSelector,this._errorClass=e.errorClass,this._submitButtonSelector=e.submitButtonSelector,this._inactiveButtonClass=e.inactiveButtonClass,this._formElement=n,this._inputList=Array.from(this._formElement.querySelectorAll(this._inputSelector)),this._buttonElement=this._formElement.querySelector(this._submitButtonSelector)}var e,n;return e=t,(n=[{key:"enableValidation",value:function(){this._setEventListeners()}},{key:"_setEventListeners",value:function(){var t=this;this._inputList.forEach((function(e){e.addEventListener("input",(function(){t._isValid(e),t._toggleButtonState()}))}))}},{key:"_isValid",value:function(t){t.validity.valid?this._hideInputError(t):this._showInputError(t,t.validationMessage)}},{key:"_showInputError",value:function(t,e){var n=this._formElement.querySelector(".".concat(t.id,"-error"));t.classList.add(this._inputErrorClass),n.textContent=e,n.classList.add(this._errorClass)}},{key:"_hideInputError",value:function(t){var e=this._formElement.querySelector(".".concat(t.id,"-error"));t.classList.remove(this._inputErrorClass),e.classList.remove(this._errorClass),e.textContent=""}},{key:"_toggleButtonState",value:function(){this._hasInvalidInput()?this._disableButton():this._enableButton()}},{key:"_hasInvalidInput",value:function(){return this._inputList.some((function(t){return!t.validity.valid}))}},{key:"_disableButton",value:function(){this._buttonElement.classList.add(this._inactiveButtonClass),this._buttonElement.setAttribute("disabled",!0)}},{key:"_enableButton",value:function(){this._buttonElement.removeAttribute("disabled"),this._buttonElement.classList.remove(this._inactiveButtonClass)}},{key:"resetValidation",value:function(){var t=this;this._toggleButtonState(),this._inputList.forEach((function(e){t._hideInputError(e)}))}}])&&V(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function H(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var F=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._url=e.baseUrl,this._headers=e.headers}var e,n;return e=t,(n=[{key:"_handleResponse",value:function(t,e){return t.ok?t.json():Promise.reject(e)}},{key:"getUserInfo",value:function(){var t=this;return fetch("".concat(this._url,"/users/me"),{method:"GET",headers:this._headers}).then((function(e){return t._handleResponse(e,"ÐÐ°Ð½Ð½ÑÐµ Ð¿Ð¾Ð»ÑÐ·Ð¾Ð²Ð°ÑÐµÐ»Ñ Ð½Ðµ Ð¿Ð¾Ð»ÑÑÐµÐ½Ñ")}))}},{key:"getInitialCards",value:function(){var t=this;return fetch("".concat(this._url,"/cards"),{method:"GET",headers:this._headers}).then((function(e){return t._handleResponse(e,"Ð¡Ð¿Ð¸ÑÐ¾Ðº ÐºÐ°ÑÑÐ¾ÑÐµÐº Ð½Ðµ Ð¿Ð¾Ð»ÑÑÐµÐ½")}))}},{key:"getInitialData",value:function(){return Promise.all([this.getUserInfo(),this.getInitialCards()])}},{key:"editUserInfo",value:function(t){var e=this;return fetch("".concat(this._url,"/users/me"),{method:"PATCH",headers:this._headers,body:JSON.stringify(t)}).then((function(t){return e._handleResponse(t,"ÐÐ°Ð½Ð½ÑÐµ Ð¿Ð¾Ð»ÑÐ·Ð¾Ð²Ð°ÑÐµÐ»Ñ Ð½Ðµ Ð¸Ð·Ð¼ÐµÐ½ÐµÐ½Ñ")}))}},{key:"addNewCard",value:function(t){var e=this;return fetch("".concat(this._url,"/cards"),{method:"POST",headers:this._headers,body:JSON.stringify(t)}).then((function(t){return e._handleResponse(t,"ÐÐ°ÑÑÐ¾ÑÐºÐ° Ð½Ðµ Ð´Ð¾Ð±Ð°Ð²Ð»ÐµÐ½Ð°")}))}},{key:"deleteCard",value:function(t){var e=this;return fetch("".concat(this._url,"/cards/").concat(t),{method:"DELETE",headers:this._headers}).then((function(t){return e._handleResponse(t,"ÐÐ°ÑÑÐ¾ÑÐºÐ° Ð½Ðµ ÑÐ´Ð°Ð»ÐµÐ½Ð°")}))}},{key:"putLike",value:function(t){var e=this;return fetch("".concat(this._url,"/cards/").concat(t,"/likes"),{method:"PUT",headers:this._headers}).then((function(t){return e._handleResponse(t,"ÐÐ°Ð¹Ðº Ð½Ðµ Ð´Ð¾Ð±Ð°Ð²Ð»ÐµÐ½")}))}},{key:"deleteLike",value:function(t){var e=this;return fetch("".concat(this._url,"/cards/").concat(t,"/likes"),{method:"DELETE",headers:this._headers}).then((function(t){return e._handleResponse(t,"ÐÐ°Ð¹Ðº Ð½Ðµ ÑÐ±ÑÐ°Ð½")}))}},{key:"updateAvatar",value:function(t){var e=this;return fetch("".concat(this._url,"/users/me/avatar"),{method:"PATCH",headers:this._headers,body:JSON.stringify(t)}).then((function(t){return e._handleResponse(t,"ÐÐ²Ð°ÑÐ°Ñ Ð¿Ð¾Ð»ÑÐ·Ð¾Ð²Ð°ÑÐµÐ»Ñ Ð½Ðµ Ð¸Ð·Ð¼ÐµÐ½ÐµÐ½")}))}}])&&H(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function J(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var G=new k(".popup_type_enlarge");G.setEventListeners();var M=new U(".popup_type_submit");function z(t){var e=t.getSubmitButton();return{submitButton:e,initialText:e.textContent}}function $(t,e){var n=e.submitButton,r=e.initialText;n.textContent=t?"Ð¡Ð¾ÑÑÐ°Ð½ÐµÐ½Ð¸Ðµ...":r}M.setEventListeners();var K=new D({nameSelector:".profile__name",aboutSelector:".profile__about",avatarSelector:".profile__photo"}),Q=new F({baseUrl:"https://mesto.nomoreparties.co/v1/cohort-41",headers:{authorization:"b6bde9be-8674-4eca-8179-302e0a4e2b6f","Content-Type":"application/json"}});Q.getInitialData().then((function(t){var e,n,r=(n=2,function(t){if(Array.isArray(t))return t}(e=t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,i=[],u=!0,a=!1;try{for(n=n.call(t);!(u=(r=n.next()).done)&&(i.push(r.value),!e||i.length!==e);u=!0);}catch(t){a=!0,o=t}finally{try{u||null==n.return||n.return()}finally{if(a)throw o}}return i}}(e,n)||function(t,e){if(t){if("string"==typeof t)return J(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?J(t,e):void 0}}(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),o=r[0],i=r[1];function u(t){return t.likes.some((function(t){return t._id===o._id}))}K.setUserInfo(o);var a=new c({items:i.reverse(),render:function(t){var e=t.owner._id!==o._id,n=u(t),r=function(t){var e=new s({data:t,handleCardClick:function(){G.open(t)},handleLikeClick:function(){function n(n){if(!n)return Promise.reject("Ð¡ÑÐµÑÑÐ¸Ðº Ð»Ð°Ð¹ÐºÐ¾Ð² Ð½Ðµ Ð¾Ð±Ð½Ð¾Ð²Ð»ÐµÐ½");e.updateÐ¡ounter(n.likes.length),t.likes=n.likes}u(t)?Q.deleteLike(t._id).then((function(t){return e.deleteLike(),t})).then((function(t){return n(t)})).catch((function(t){return console.log("ÐÑÐ¸Ð±ÐºÐ°: ".concat(t))})):Q.putLike(t._id).then((function(t){return e.putLike(),t})).then((function(t){return n(t)})).catch((function(t){return console.log("ÐÑÐ¸Ð±ÐºÐ°: ".concat(t))}))},handleDeleteButtonClick:function(){M.setHandler((function(){Q.deleteCard(t._id).then((function(){e.deleteCard(),M.close()})).catch((function(t){return console.log("ÐÑÐ¸Ð±ÐºÐ°: ".concat(t))}))})),M.open()}},".place-template");return e}(t).generateCard({isNotUserCard:e,isLikedByUser:n});a.addItem(r)}},".places__list");return a.renderItems(),{userData:o,initialCardsData:i,cardList:a}})).then((function(t){return function(t){u.forEach((function(e){var n=new N(t,e),r=e.getAttribute("name");i[r]=n,n.enableValidation()}))}(o),t})).then((function(t){var n=new j(".popup_type_edit",(function(t){var e=z(n);$(!0,e),Q.editUserInfo(t).then((function(t){K.setUserInfo(t)})).then((function(){n.close()})).catch((function(t){return console.log("ÐÑÐ¸Ð±ÐºÐ°: ".concat(t))})).finally((function(){$(!1,e)}))}));return n.setEventListeners(),e.addEventListener("click",(function(){n.setInputValues(K.getUserInfo()),i.edit.resetValidation(),n.open()})),t})).then((function(t){var e=new j(".popup_type_add",(function(n){var r=z(e);$(!0,r);var o={name:n.place,link:n.link};Q.addNewCard(o).then((function(e){t.cardList.renderOneItem(e)})).then((function(){e.close()})).catch((function(t){return console.log("ÐÑÐ¸Ð±ÐºÐ°: ".concat(t))})).finally((function(){$(!1,r)}))}));return e.setEventListeners(),n.addEventListener("click",(function(){i.add.resetValidation(),e.open()})),t})).then((function(t){var e=new j(".popup_type_update-avatar",(function(t){var n=z(e);$(!0,n);var r={avatar:t["avatar-link"]};Q.updateAvatar(r).then((function(t){K.setUserInfo(t)})).then((function(){e.close()})).catch((function(t){return console.log("ÐÑÐ¸Ð±ÐºÐ°: ".concat(t))})).finally((function(){$(!1,n)}))}));return e.setEventListeners(),r.addEventListener("click",(function(){i["update-avatar"].resetValidation(),e.open()})),t})).catch((function(t){return console.log("ÐÑÐ¸Ð±ÐºÐ°: ".concat(t))}))})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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V0FDSjBELEVBQW9CckksV0FFckI2RyxPQUFNLFNBQUNDLEdBQUQsT0FBV0MsUUFBUUMsSUFBUixrQkFBdUJGLE9BQ3hDaUIsU0FBUSxXQUNQcEMsR0FBdUIsRUFBT0QsU0FlcEMsT0FYQTJDLEVBQW9CakQsb0JBU3BCcEssRUFBd0JvRSxpQkFBaUIsU0FMekMsV0FDRTVELEVBQWUsaUJBQWZBLGtCQUNBNk0sRUFBb0I1QixVQUtmYyxLQUdSVixPQUFNLFNBQUNDLEdBQUQsT0FBV0MsUUFBUUMsSUFBUixrQkFBdUJGLFEiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9tZXN0by8uL3NyYy9zY3JpcHRzL3V0aWxzL2NvbnN0YW50cy5qcyIsIndlYnBhY2s6Ly9tZXN0by8uL3NyYy9zY3JpcHRzL2NvbXBvbmVudHMvU2VjdGlvbi5qcyIsIndlYnBhY2s6Ly9tZXN0by8uL3NyYy9zY3JpcHRzL2NvbXBvbmVudHMvQ2FyZC5qcyIsIndlYnBhY2s6Ly9tZXN0by8uL3NyYy9zY3JpcHRzL2NvbXBvbmVudHMvUG9wdXAuanMiLCJ3ZWJwYWNrOi8vbWVzdG8vLi9zcmMvc2NyaXB0cy9jb21wb25lbnRzL1BvcHVwV2l0aEltYWdlLmpzIiwid2VicGFjazovL21lc3RvLy4vc3JjL3NjcmlwdHMvY29tcG9uZW50cy9Qb3B1cFdpdGhGb3JtLmpzIiwid2VicGFjazovL21lc3RvLy4vc3JjL3NjcmlwdHMvY29tcG9uZW50cy9Qb3B1cFdpdGhDb25maXJtYXRpb24uanMiLCJ3ZWJwYWNrOi8vbWVzdG8vLi9zcmMvc2NyaXB0cy9jb21wb25lbnRzL1VzZXJJbmZvLmpzIiwid2VicGFjazovL21lc3RvLy4vc3JjL3NjcmlwdHMvY29tcG9uZW50cy9Gb3JtVmFsaWRhdG9yLmpzIiwid2VicGFjazovL21lc3RvLy4vc3JjL3NjcmlwdHMvY29tcG9uZW50cy9BcGkuanMiLCJ3ZWJwYWNrOi8vbWVzdG8vLi9zcmMvcGFnZXMvaW5kZXgvaW5kZXguanMiXSwic291cmNlc0NvbnRlbnQiOlsiZXhwb3J0IGNvbnN0IHByb2ZpbGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucHJvZmlsZScpO1xyXG5leHBvcnQgY29uc3QgYnV0dG9uRm9yRWRpdGluZ1Byb2ZpbGUgPSBwcm9maWxlLnF1ZXJ5U2VsZWN0b3IoJy5wcm9maWxlX19lZGl0LWJ1dHRvbicpO1xyXG5leHBvcnQgY29uc3QgYnV0dG9uRm9yQWRkaW5nQ2FyZCA9IHByb2ZpbGUucXVlcnlTZWxlY3RvcignLnByb2ZpbGVfX2FkZC1idXR0b24nKTtcclxuZXhwb3J0IGNvbnN0IGJ1dHRvbkZvclVwZGF0aW5nQXZhdGFyID0gcHJvZmlsZS5xdWVyeVNlbGVjdG9yKCcucHJvZmlsZV9fdXBkYXRlLWJ1dHRvbicpO1xyXG5cclxuZXhwb3J0IGNvbnN0IGNhcmRzU2VsZWN0b3IgPSAnLnBsYWNlc19fbGlzdCc7XHJcblxyXG5leHBvcnQgY29uc3QgY29uZmlnID0ge1xyXG4gIGlucHV0U2VsZWN0b3I6ICcucG9wdXBfX2lucHV0JyxcclxuICBpbnB1dEVycm9yQ2xhc3M6ICdwb3B1cF9faW5wdXRfdHlwZV9lcnJvcicsXHJcbiAgZXJyb3JTZWxlY3RvcjogJy5wb3B1cF9fZXJyb3InLFxyXG4gIGVycm9yQ2xhc3M6ICdwb3B1cF9fZXJyb3JfYWN0aXZlJyxcclxuICBzdWJtaXRCdXR0b25TZWxlY3RvcjogJy5wb3B1cF9fc3VibWl0LWJ1dHRvbicsXHJcbiAgaW5hY3RpdmVCdXR0b25DbGFzczogJ3BvcHVwX19zdWJtaXQtYnV0dG9uX2Rpc2FibGVkJyxcclxufTtcclxuXHJcbmV4cG9ydCBjb25zdCBmb3JtVmFsaWRhdG9ycyA9IHt9O1xyXG5leHBvcnQgY29uc3QgZm9ybUxpc3QgPSBBcnJheS5mcm9tKGRvY3VtZW50LmZvcm1zKTtcclxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgU2VjdGlvbiB7XHJcbiAgY29uc3RydWN0b3IoeyBpdGVtcywgcmVuZGVyIH0sIGNvbnRhaW5lclNlbGVjdG9yKSB7XHJcbiAgICB0aGlzLl9pdGVtcyA9IGl0ZW1zO1xyXG4gICAgdGhpcy5fcmVuZGVyZXIgPSByZW5kZXI7XHJcbiAgICB0aGlzLl9jb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGNvbnRhaW5lclNlbGVjdG9yKTtcclxuICB9XHJcblxyXG4gIHJlbmRlckl0ZW1zKCkge1xyXG4gICAgdGhpcy5faXRlbXMuZm9yRWFjaCgoaXRlbSkgPT4ge1xyXG4gICAgICB0aGlzLl9yZW5kZXJlcihpdGVtKTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgcmVuZGVyT25lSXRlbShpdGVtKSB7XHJcbiAgICB0aGlzLl9yZW5kZXJlcihpdGVtKTtcclxuICB9XHJcblxyXG4gIGFkZEl0ZW0oZWxlbWVudCkge1xyXG4gICAgdGhpcy5fY29udGFpbmVyLnByZXBlbmQoZWxlbWVudCk7XHJcbiAgfVxyXG59XHJcbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIENhcmQge1xyXG4gIGNvbnN0cnVjdG9yKHsgZGF0YSwgaGFuZGxlQ2FyZENsaWNrLCBoYW5kbGVMaWtlQ2xpY2ssIGhhbmRsZURlbGV0ZUJ1dHRvbkNsaWNrIH0sIGNhcmRTZWxlY3Rvcikge1xyXG4gICAgdGhpcy5fZGF0YSA9IGRhdGE7XHJcbiAgICB0aGlzLl90aXRsZSA9IHRoaXMuX2RhdGEubmFtZTtcclxuICAgIHRoaXMuX2xpbmsgPSB0aGlzLl9kYXRhLmxpbms7XHJcbiAgICB0aGlzLl9saWtlcyA9IHRoaXMuX2RhdGEubGlrZXMubGVuZ3RoO1xyXG4gICAgdGhpcy5faWQgPSB0aGlzLl9kYXRhLl9pZDtcclxuICAgIHRoaXMuX293bmVySWQgPSB0aGlzLl9kYXRhLm93bmVyLl9pZDtcclxuXHJcbiAgICB0aGlzLl9hbHQgPSB0aGlzLl90aXRsZTtcclxuXHJcbiAgICB0aGlzLl9oYW5kbGVDYXJkQ2xpY2sgPSBoYW5kbGVDYXJkQ2xpY2s7XHJcbiAgICB0aGlzLl9oYW5kbGVMaWtlQ2xpY2sgPSBoYW5kbGVMaWtlQ2xpY2s7XHJcbiAgICB0aGlzLl9oYW5kbGVEZWxldGVCdXR0b25DbGljayA9IGhhbmRsZURlbGV0ZUJ1dHRvbkNsaWNrO1xyXG4gICAgdGhpcy5fY2FyZFNlbGVjdG9yID0gY2FyZFNlbGVjdG9yO1xyXG4gIH1cclxuXHJcbiAgX2dldFRlbXBsYXRlKCkge1xyXG4gICAgY29uc3QgY2FyZEVsZW1lbnQgPSBkb2N1bWVudFxyXG4gICAgICAucXVlcnlTZWxlY3Rvcih0aGlzLl9jYXJkU2VsZWN0b3IpXHJcbiAgICAgIC5jb250ZW50LnF1ZXJ5U2VsZWN0b3IoJy5wbGFjZScpXHJcbiAgICAgIC5jbG9uZU5vZGUodHJ1ZSk7XHJcblxyXG4gICAgcmV0dXJuIGNhcmRFbGVtZW50O1xyXG4gIH1cclxuXHJcbiAgX2NoZWNrQ2FyZChpc05vdFVzZXJDYXJkKSB7XHJcbiAgICBpZiAoaXNOb3RVc2VyQ2FyZCkge1xyXG4gICAgICB0aGlzLl9kZWxldGVCdXR0b24ucmVtb3ZlKCk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBfY2hlY2tMaWtlKGlzTGlrZWRCeVVzZXIpIHtcclxuICAgIGlmIChpc0xpa2VkQnlVc2VyKSB7XHJcbiAgICAgIHRoaXMucHV0TGlrZSgpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgZ2VuZXJhdGVDYXJkKGNoZdGBa3MpIHtcclxuICAgIHRoaXMuX2VsZW1lbnQgPSB0aGlzLl9nZXRUZW1wbGF0ZSgpO1xyXG4gICAgdGhpcy5fbGlrZUJ1dHRvbiA9IHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcignLnBsYWNlX19saWtlLWJ1dHRvbicpO1xyXG4gICAgdGhpcy5fZGVsZXRlQnV0dG9uID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKCcucGxhY2VfX2RlbGV0ZS1idXR0b24nKTtcclxuICAgIHRoaXMuX2VubGFyZ2VCdXR0b24gPSB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wbGFjZV9fZW5sYXJnZS1idXR0b24nKTtcclxuICAgIHRoaXMuX2NhcmRMaWtlcyA9IHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcignLnBsYWNlX19saWtlLWNvdW50ZXInKTtcclxuXHJcbiAgICBjb25zdCBjYXJkVGl0bGUgPSB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wbGFjZV9fdGl0bGUnKTtcclxuICAgIGNvbnN0IGNhcmRJbWFnZSA9IHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcignLnBsYWNlX19pbWFnZScpO1xyXG5cclxuICAgIGNhcmRUaXRsZS50ZXh0Q29udGVudCA9IHRoaXMuX3RpdGxlO1xyXG4gICAgY2FyZEltYWdlLnNyYyA9IHRoaXMuX2xpbms7XHJcbiAgICBjYXJkSW1hZ2UuYWx0ID0gdGhpcy5fYWx0O1xyXG5cclxuICAgIHRoaXMuX2NhcmRMaWtlcy50ZXh0Q29udGVudCA9IHRoaXMuX2xpa2VzO1xyXG5cclxuICAgIHRoaXMuX3NldEV2ZW50TGlzdGVuZXJzKCk7XHJcblxyXG4gICAgdGhpcy5fY2hlY2tDYXJkKGNoZdGBa3MuaXNOb3RVc2VyQ2FyZCk7XHJcbiAgICB0aGlzLl9jaGVja0xpa2UoY2hl0YFrcy5pc0xpa2VkQnlVc2VyKTtcclxuXHJcbiAgICByZXR1cm4gdGhpcy5fZWxlbWVudDtcclxuICB9XHJcblxyXG4gIF9zZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgIHRoaXMuX2xpa2VCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XHJcbiAgICAgIHRoaXMuX2hhbmRsZUxpa2VDbGljaygpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgaWYgKHRoaXMuX2RlbGV0ZUJ1dHRvbikge1xyXG4gICAgICB0aGlzLl9kZWxldGVCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XHJcbiAgICAgICAgdGhpcy5faGFuZGxlRGVsZXRlQnV0dG9uQ2xpY2soKTtcclxuICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgdGhpcy5fZW5sYXJnZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcclxuICAgICAgdGhpcy5faGFuZGxlQ2FyZENsaWNrKCk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIGRlbGV0ZUNhcmQoKSB7XHJcbiAgICB0aGlzLl9lbGVtZW50LnJlbW92ZSgpO1xyXG4gICAgdGhpcy5fZWxlbWVudCA9IG51bGw7XHJcbiAgfVxyXG5cclxuICBwdXRMaWtlKCkge1xyXG4gICAgdGhpcy5fbGlrZUJ1dHRvbi5jbGFzc0xpc3QuYWRkKCdwbGFjZV9fbGlrZS1idXR0b25fYWN0aXZlJyk7XHJcbiAgfVxyXG5cclxuICBkZWxldGVMaWtlKCkge1xyXG4gICAgdGhpcy5fbGlrZUJ1dHRvbi5jbGFzc0xpc3QucmVtb3ZlKCdwbGFjZV9fbGlrZS1idXR0b25fYWN0aXZlJyk7XHJcbiAgfVxyXG5cclxuICB1cGRhdGXQoW91bnRlcihsaWtlcykge1xyXG4gICAgdGhpcy5fY2FyZExpa2VzLnRleHRDb250ZW50ID0gbGlrZXM7XHJcbiAgfVxyXG59XHJcbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwIHtcbiAgY29uc3RydWN0b3IocG9wdXBTZWxlY3Rvcikge1xuICAgIHRoaXMuX3BvcHVwU2VsZWN0b3IgPSBwb3B1cFNlbGVjdG9yO1xuICAgIHRoaXMuX3BvcHVwID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcih0aGlzLl9wb3B1cFNlbGVjdG9yKTtcbiAgICB0aGlzLl9vcGVuUG9wdXBTZWxlY3RvciA9ICdwb3B1cF9vcGVuZWQnO1xuICAgIHRoaXMuX2hhbmRsZUVzY0Nsb3NlID0gdGhpcy5faGFuZGxlRXNjQ2xvc2UuYmluZCh0aGlzKTtcbiAgfVxuXG4gIF9oYW5kbGVFc2NDbG9zZShldmVudCkge1xuICAgIGlmIChldmVudC5rZXkgPT09ICdFc2NhcGUnKSB7XG4gICAgICB0aGlzLmNsb3NlKCk7XG4gICAgfVxuICB9XG5cbiAgb3BlbigpIHtcbiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdrZXlkb3duJywgdGhpcy5faGFuZGxlRXNjQ2xvc2UpO1xuICAgIHRoaXMuX3BvcHVwLmNsYXNzTGlzdC5hZGQodGhpcy5fb3BlblBvcHVwU2VsZWN0b3IpO1xuICB9XG5cbiAgY2xvc2UoKSB7XG4gICAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIHRoaXMuX2hhbmRsZUVzY0Nsb3NlKTtcbiAgICB0aGlzLl9wb3B1cC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX29wZW5Qb3B1cFNlbGVjdG9yKTtcbiAgfVxuXG4gIF9oYW5kbGVDbGlja0Nsb3NlKGV2ZW50KSB7XG4gICAgaWYgKFxuICAgICAgZXZlbnQudGFyZ2V0ID09PSBldmVudC5jdXJyZW50VGFyZ2V0IHx8XG4gICAgICBldmVudC50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKCdwb3B1cF9fY2xvc2UtYnV0dG9uJylcbiAgICApIHtcbiAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICB9XG4gIH1cblxuICBzZXRFdmVudExpc3RlbmVycygpIHtcbiAgICB0aGlzLl9wb3B1cC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIChldmVudCkgPT4ge1xuICAgICAgdGhpcy5faGFuZGxlQ2xpY2tDbG9zZShldmVudCk7XG4gICAgfSk7XG4gIH1cbn1cbiIsImltcG9ydCBQb3B1cCBmcm9tICcuL1BvcHVwLmpzJztcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwV2l0aEltYWdlIGV4dGVuZHMgUG9wdXAge1xyXG4gIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IpIHtcclxuICAgIHN1cGVyKHBvcHVwU2VsZWN0b3IpO1xyXG4gICAgdGhpcy5fcG9wdXBJbWFnZSA9IHRoaXMuX3BvcHVwLnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF9faW1hZ2UnKTtcclxuICAgIHRoaXMuX3BvcHVwSW1hZ2VDYXB0aW9uID0gdGhpcy5fcG9wdXAucXVlcnlTZWxlY3RvcignLnBvcHVwX19pbWFnZS1jYXB0aW9uJyk7XHJcbiAgfVxyXG5cclxuICBvcGVuKGRhdGEpIHtcclxuICAgIHRoaXMuX3BvcHVwSW1hZ2VDYXB0aW9uLnRleHRDb250ZW50ID0gZGF0YS5uYW1lO1xyXG4gICAgdGhpcy5fcG9wdXBJbWFnZS5zcmMgPSBkYXRhLmxpbms7XHJcbiAgICB0aGlzLl9wb3B1cEltYWdlLmFsdCA9IHRoaXMuX3BvcHVwSW1hZ2VDYXB0aW9uLnRleHRDb250ZW50O1xyXG5cclxuICAgIHN1cGVyLm9wZW4oKTtcclxuICB9XHJcbn1cclxuIiwiaW1wb3J0IFBvcHVwIGZyb20gJy4vUG9wdXAuanMnO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXBXaXRoRm9ybSBleHRlbmRzIFBvcHVwIHtcclxuICBjb25zdHJ1Y3Rvcihwb3B1cFNlbGVjdG9yLCBoYW5kbGVGb3JtU3VibWl0KSB7XHJcbiAgICBzdXBlcihwb3B1cFNlbGVjdG9yKTtcclxuICAgIHRoaXMuX2hhbmRsZVN1Ym1pdEZvcm0gPSBoYW5kbGVGb3JtU3VibWl0O1xyXG4gICAgdGhpcy5fZm9ybUVsZW1lbnQgPSB0aGlzLl9wb3B1cC5xdWVyeVNlbGVjdG9yKCcucG9wdXBfX2Zvcm0nKTtcclxuICAgIHRoaXMuX2lucHV0TGlzdCA9IHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5wb3B1cF9faW5wdXQnKTtcclxuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbkVsZW1lbnQgPSB0aGlzLl9wb3B1cC5xdWVyeVNlbGVjdG9yKCcucG9wdXBfX3N1Ym1pdC1idXR0b24nKTtcclxuICB9XHJcblxyXG4gIGNsb3NlKCkge1xyXG4gICAgc3VwZXIuY2xvc2UoKTtcclxuICAgIHRoaXMuX2Zvcm1FbGVtZW50LnJlc2V0KCk7XHJcbiAgfVxyXG5cclxuICBfZ2V0SW5wdXRWYWx1ZXMoKSB7XHJcbiAgICB0aGlzLl9mb3JtVmFsdWVzID0ge307XHJcbiAgICB0aGlzLl9pbnB1dExpc3QuZm9yRWFjaCgoaW5wdXQpID0+IHtcclxuICAgICAgdGhpcy5fZm9ybVZhbHVlc1tpbnB1dC5uYW1lXSA9IGlucHV0LnZhbHVlO1xyXG4gICAgfSk7XHJcblxyXG4gICAgcmV0dXJuIHRoaXMuX2Zvcm1WYWx1ZXM7XHJcbiAgfVxyXG5cclxuICBzZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgIHN1cGVyLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcblxyXG4gICAgdGhpcy5fZm9ybUVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignc3VibWl0JywgKGV2ZW50KSA9PiB7XHJcbiAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgIHRoaXMuX2hhbmRsZVN1Ym1pdEZvcm0odGhpcy5fZ2V0SW5wdXRWYWx1ZXMoKSk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIGdldFBvcHVwRm9ybSgpIHtcclxuICAgIHJldHVybiB0aGlzLl9mb3JtRWxlbWVudDtcclxuICB9XHJcblxyXG4gIHNldElucHV0VmFsdWVzKGRhdGEpIHtcclxuICAgIHRoaXMuX2lucHV0TGlzdC5mb3JFYWNoKChpbnB1dCkgPT4ge1xyXG4gICAgICBpbnB1dC52YWx1ZSA9IGRhdGFbaW5wdXQubmFtZV07XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIGdldFN1Ym1pdEJ1dHRvbigpIHtcclxuICAgIHJldHVybiB0aGlzLl9zdWJtaXRCdXR0b25FbGVtZW50O1xyXG4gIH1cclxufVxyXG4iLCJpbXBvcnQgUG9wdXAgZnJvbSAnLi9Qb3B1cC5qcyc7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cFdpdGhDb25maXJtYXRpb24gZXh0ZW5kcyBQb3B1cCB7XHJcbiAgY29uc3RydWN0b3IocG9wdXBTZWxlY3Rvcikge1xyXG4gICAgc3VwZXIocG9wdXBTZWxlY3Rvcik7XHJcbiAgICB0aGlzLl9oYW5kbGVDbGlja1N1Ym1pdCA9IHt9O1xyXG4gICAgdGhpcy5fc3VibWl0QnV0dG9uRWxlbWVudCA9IHRoaXMuX3BvcHVwLnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF9fc3VibWl0LWJ1dHRvbicpO1xyXG4gIH1cclxuXHJcbiAgc2V0SGFuZGxlcihoYW5kbGVyKSB7XHJcbiAgICB0aGlzLl9oYW5kbGVDbGlja1N1Ym1pdCA9IGhhbmRsZXI7XHJcbiAgfVxyXG5cclxuICBzZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgIHN1cGVyLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcblxyXG4gICAgdGhpcy5fc3VibWl0QnV0dG9uRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcclxuICAgICAgdGhpcy5faGFuZGxlQ2xpY2tTdWJtaXQoKTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgZ2V0U3VibWl0QnV0dG9uKCkge1xyXG4gICAgcmV0dXJuIHRoaXMuX3N1Ym1pdEJ1dHRvbkVsZW1lbnQ7XHJcbiAgfVxyXG59XHJcbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFVzZXJJbmZvIHtcclxuICBjb25zdHJ1Y3Rvcih7IG5hbWVTZWxlY3RvciwgYWJvdXRTZWxlY3RvciwgYXZhdGFyU2VsZWN0b3IgfSkge1xyXG4gICAgdGhpcy5fbmFtZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IobmFtZVNlbGVjdG9yKTtcclxuICAgIHRoaXMuX2Fib3V0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihhYm91dFNlbGVjdG9yKTtcclxuICAgIHRoaXMuX2F2YXRhciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYXZhdGFyU2VsZWN0b3IpO1xyXG4gIH1cclxuXHJcbiAgZ2V0VXNlckluZm8oKSB7XHJcbiAgICBjb25zdCB1c2VySW5mb1Byb2ZpbGUgPSB7XHJcbiAgICAgIG5hbWU6IHRoaXMuX25hbWUudGV4dENvbnRlbnQsXHJcbiAgICAgIGFib3V0OiB0aGlzLl9hYm91dC50ZXh0Q29udGVudCxcclxuICAgICAgYXZhdGFyOiB0aGlzLl9hdmF0YXIuc3JjLFxyXG4gICAgfTtcclxuXHJcbiAgICByZXR1cm4gdXNlckluZm9Qcm9maWxlO1xyXG4gIH1cclxuXHJcbiAgc2V0VXNlckluZm8odXNlckRhdGEpIHtcclxuICAgIHRoaXMuX25hbWUudGV4dENvbnRlbnQgPSB1c2VyRGF0YS5uYW1lO1xyXG4gICAgdGhpcy5fYWJvdXQudGV4dENvbnRlbnQgPSB1c2VyRGF0YS5hYm91dDtcclxuICAgIHRoaXMuX2F2YXRhci5zcmMgPSB1c2VyRGF0YS5hdmF0YXI7XHJcbiAgfVxyXG59XHJcbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIEZvcm1WYWxpZGF0b3Ige1xyXG4gIGNvbnN0cnVjdG9yKGNvbmZpZywgZm9ybUVsZW1lbnQpIHtcclxuICAgIHRoaXMuX2lucHV0U2VsZWN0b3IgPSBjb25maWcuaW5wdXRTZWxlY3RvcjtcclxuICAgIHRoaXMuX2lucHV0RXJyb3JDbGFzcyA9IGNvbmZpZy5pbnB1dEVycm9yQ2xhc3M7XHJcbiAgICB0aGlzLl9lcnJvclNlbGVjdG9yID0gY29uZmlnLmVycm9yU2VsZWN0b3I7XHJcbiAgICB0aGlzLl9lcnJvckNsYXNzID0gY29uZmlnLmVycm9yQ2xhc3M7XHJcbiAgICB0aGlzLl9zdWJtaXRCdXR0b25TZWxlY3RvciA9IGNvbmZpZy5zdWJtaXRCdXR0b25TZWxlY3RvcjtcclxuICAgIHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MgPSBjb25maWcuaW5hY3RpdmVCdXR0b25DbGFzcztcclxuICAgIHRoaXMuX2Zvcm1FbGVtZW50ID0gZm9ybUVsZW1lbnQ7XHJcbiAgICB0aGlzLl9pbnB1dExpc3QgPSBBcnJheS5mcm9tKHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwodGhpcy5faW5wdXRTZWxlY3RvcikpO1xyXG4gICAgdGhpcy5fYnV0dG9uRWxlbWVudCA9IHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IodGhpcy5fc3VibWl0QnV0dG9uU2VsZWN0b3IpO1xyXG4gIH1cclxuXHJcbiAgZW5hYmxlVmFsaWRhdGlvbigpIHtcclxuICAgIHRoaXMuX3NldEV2ZW50TGlzdGVuZXJzKCk7XHJcbiAgfVxyXG5cclxuICBfc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICB0aGlzLl9pbnB1dExpc3QuZm9yRWFjaCgoaW5wdXRFbGVtZW50KSA9PiB7XHJcbiAgICAgIGlucHV0RWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCdpbnB1dCcsICgpID0+IHtcclxuICAgICAgICB0aGlzLl9pc1ZhbGlkKGlucHV0RWxlbWVudCk7XHJcbiAgICAgICAgdGhpcy5fdG9nZ2xlQnV0dG9uU3RhdGUoKTtcclxuICAgICAgfSk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIF9pc1ZhbGlkKGlucHV0RWxlbWVudCkge1xyXG4gICAgaWYgKCFpbnB1dEVsZW1lbnQudmFsaWRpdHkudmFsaWQpIHtcclxuICAgICAgdGhpcy5fc2hvd0lucHV0RXJyb3IoaW5wdXRFbGVtZW50LCBpbnB1dEVsZW1lbnQudmFsaWRhdGlvbk1lc3NhZ2UpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgdGhpcy5faGlkZUlucHV0RXJyb3IoaW5wdXRFbGVtZW50KTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIF9zaG93SW5wdXRFcnJvcihpbnB1dEVsZW1lbnQsIGVycm9yTWVzc2FnZSkge1xyXG4gICAgY29uc3QgZXJyb3JFbGVtZW50ID0gdGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvcihgLiR7aW5wdXRFbGVtZW50LmlkfS1lcnJvcmApO1xyXG5cclxuICAgIGlucHV0RWxlbWVudC5jbGFzc0xpc3QuYWRkKHRoaXMuX2lucHV0RXJyb3JDbGFzcyk7XHJcbiAgICBlcnJvckVsZW1lbnQudGV4dENvbnRlbnQgPSBlcnJvck1lc3NhZ2U7XHJcbiAgICBlcnJvckVsZW1lbnQuY2xhc3NMaXN0LmFkZCh0aGlzLl9lcnJvckNsYXNzKTtcclxuICB9XHJcblxyXG4gIF9oaWRlSW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpIHtcclxuICAgIGNvbnN0IGVycm9yRWxlbWVudCA9IHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoYC4ke2lucHV0RWxlbWVudC5pZH0tZXJyb3JgKTtcclxuXHJcbiAgICBpbnB1dEVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9pbnB1dEVycm9yQ2xhc3MpO1xyXG4gICAgZXJyb3JFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUodGhpcy5fZXJyb3JDbGFzcyk7XHJcbiAgICBlcnJvckVsZW1lbnQudGV4dENvbnRlbnQgPSAnJztcclxuICB9XHJcblxyXG4gIF90b2dnbGVCdXR0b25TdGF0ZSgpIHtcclxuICAgIGlmICh0aGlzLl9oYXNJbnZhbGlkSW5wdXQoKSkge1xyXG4gICAgICB0aGlzLl9kaXNhYmxlQnV0dG9uKCk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICB0aGlzLl9lbmFibGVCdXR0b24oKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIF9oYXNJbnZhbGlkSW5wdXQoKSB7XHJcbiAgICByZXR1cm4gdGhpcy5faW5wdXRMaXN0LnNvbWUoKGlucHV0RWxlbWVudCkgPT4ge1xyXG4gICAgICByZXR1cm4gIWlucHV0RWxlbWVudC52YWxpZGl0eS52YWxpZDtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgX2Rpc2FibGVCdXR0b24oKSB7XHJcbiAgICB0aGlzLl9idXR0b25FbGVtZW50LmNsYXNzTGlzdC5hZGQodGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcyk7XHJcbiAgICB0aGlzLl9idXR0b25FbGVtZW50LnNldEF0dHJpYnV0ZSgnZGlzYWJsZWQnLCB0cnVlKTtcclxuICB9XHJcblxyXG4gIF9lbmFibGVCdXR0b24oKSB7XHJcbiAgICB0aGlzLl9idXR0b25FbGVtZW50LnJlbW92ZUF0dHJpYnV0ZSgnZGlzYWJsZWQnKTtcclxuICAgIHRoaXMuX2J1dHRvbkVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcclxuICB9XHJcblxyXG4gIHJlc2V0VmFsaWRhdGlvbigpIHtcclxuICAgIHRoaXMuX3RvZ2dsZUJ1dHRvblN0YXRlKCk7XHJcbiAgICB0aGlzLl9pbnB1dExpc3QuZm9yRWFjaCgoaW5wdXRFbGVtZW50KSA9PiB7XHJcbiAgICAgIHRoaXMuX2hpZGVJbnB1dEVycm9yKGlucHV0RWxlbWVudCk7XHJcbiAgICB9KTtcclxuICB9XHJcbn1cclxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgQXBpIHtcclxuICBjb25zdHJ1Y3RvcihvcHRpb25zKSB7XHJcbiAgICB0aGlzLl91cmwgPSBvcHRpb25zLmJhc2VVcmw7XHJcbiAgICB0aGlzLl9oZWFkZXJzID0gb3B0aW9ucy5oZWFkZXJzO1xyXG4gIH1cclxuXHJcbiAgX2hhbmRsZVJlc3BvbnNlKHJlcywgZXJyb3JUZXh0KSB7XHJcbiAgICBpZiAocmVzLm9rKSB7XHJcbiAgICAgIHJldHVybiByZXMuanNvbigpO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGVycm9yVGV4dCk7XHJcbiAgfVxyXG5cclxuICBnZXRVc2VySW5mbygpIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl91cmx9L3VzZXJzL21lYCwge1xyXG4gICAgICBtZXRob2Q6ICdHRVQnLFxyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgfSkudGhlbigocmVzKSA9PiB7XHJcbiAgICAgIHJldHVybiB0aGlzLl9oYW5kbGVSZXNwb25zZShyZXMsICfQlNCw0L3QvdGL0LUg0L/QvtC70YzQt9C+0LLQsNGC0LXQu9GPINC90LUg0L/QvtC70YPRh9C10L3RiycpO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBnZXRJbml0aWFsQ2FyZHMoKSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fdXJsfS9jYXJkc2AsIHtcclxuICAgICAgbWV0aG9kOiAnR0VUJyxcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgIH0pLnRoZW4oKHJlcykgPT4ge1xyXG4gICAgICByZXR1cm4gdGhpcy5faGFuZGxlUmVzcG9uc2UocmVzLCAn0KHQv9C40YHQvtC6INC60LDRgNGC0L7Rh9C10Log0L3QtSDQv9C+0LvRg9GH0LXQvScpO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBnZXRJbml0aWFsRGF0YSgpIHtcclxuICAgIHJldHVybiBQcm9taXNlLmFsbChbdGhpcy5nZXRVc2VySW5mbygpLCB0aGlzLmdldEluaXRpYWxDYXJkcygpXSk7XHJcbiAgfVxyXG5cclxuICBlZGl0VXNlckluZm8oZGF0YSkge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX3VybH0vdXNlcnMvbWVgLCB7XHJcbiAgICAgIG1ldGhvZDogJ1BBVENIJyxcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoZGF0YSksXHJcbiAgICB9KS50aGVuKChyZXMpID0+IHtcclxuICAgICAgcmV0dXJuIHRoaXMuX2hhbmRsZVJlc3BvbnNlKHJlcywgJ9CU0LDQvdC90YvQtSDQv9C+0LvRjNC30L7QstCw0YLQtdC70Y8g0L3QtSDQuNC30LzQtdC90LXQvdGLJyk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIGFkZE5ld0NhcmQoZGF0YSkge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX3VybH0vY2FyZHNgLCB7XHJcbiAgICAgIG1ldGhvZDogJ1BPU1QnLFxyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeShkYXRhKSxcclxuICAgIH0pLnRoZW4oKHJlcykgPT4ge1xyXG4gICAgICByZXR1cm4gdGhpcy5faGFuZGxlUmVzcG9uc2UocmVzLCAn0JrQsNGA0YLQvtGH0LrQsCDQvdC1INC00L7QsdCw0LLQu9C10L3QsCcpO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBkZWxldGVDYXJkKGlkKSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fdXJsfS9jYXJkcy8ke2lkfWAsIHtcclxuICAgICAgbWV0aG9kOiAnREVMRVRFJyxcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgIH0pLnRoZW4oKHJlcykgPT4ge1xyXG4gICAgICByZXR1cm4gdGhpcy5faGFuZGxlUmVzcG9uc2UocmVzLCAn0JrQsNGA0YLQvtGH0LrQsCDQvdC1INGD0LTQsNC70LXQvdCwJyk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIHB1dExpa2UoaWQpIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl91cmx9L2NhcmRzLyR7aWR9L2xpa2VzYCwge1xyXG4gICAgICBtZXRob2Q6ICdQVVQnLFxyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgfSkudGhlbigocmVzKSA9PiB7XHJcbiAgICAgIHJldHVybiB0aGlzLl9oYW5kbGVSZXNwb25zZShyZXMsICfQm9Cw0LnQuiDQvdC1INC00L7QsdCw0LLQu9C10L0nKTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgZGVsZXRlTGlrZShpZCkge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX3VybH0vY2FyZHMvJHtpZH0vbGlrZXNgLCB7XHJcbiAgICAgIG1ldGhvZDogJ0RFTEVURScsXHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICB9KS50aGVuKChyZXMpID0+IHtcclxuICAgICAgcmV0dXJuIHRoaXMuX2hhbmRsZVJlc3BvbnNlKHJlcywgJ9Cb0LDQudC6INC90LUg0YPQsdGA0LDQvScpO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICB1cGRhdGVBdmF0YXIoZGF0YSkge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX3VybH0vdXNlcnMvbWUvYXZhdGFyYCwge1xyXG4gICAgICBtZXRob2Q6ICdQQVRDSCcsXHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KGRhdGEpLFxyXG4gICAgfSkudGhlbigocmVzKSA9PiB7XHJcbiAgICAgIHJldHVybiB0aGlzLl9oYW5kbGVSZXNwb25zZShyZXMsICfQkNCy0LDRgtCw0YAg0L/QvtC70YzQt9C+0LLQsNGC0LXQu9GPINC90LUg0LjQt9C80LXQvdC10L0nKTtcclxuICAgIH0pO1xyXG4gIH1cclxufVxyXG4iLCJpbXBvcnQgJy4vaW5kZXguY3NzJztcclxuXHJcbmltcG9ydCB7XHJcbiAgYnV0dG9uRm9yRWRpdGluZ1Byb2ZpbGUsXHJcbiAgYnV0dG9uRm9yQWRkaW5nQ2FyZCxcclxuICBidXR0b25Gb3JVcGRhdGluZ0F2YXRhcixcclxuICBjYXJkc1NlbGVjdG9yLFxyXG4gIGNvbmZpZyxcclxuICBmb3JtVmFsaWRhdG9ycyxcclxuICBmb3JtTGlzdCxcclxufSBmcm9tICcuLi8uLi9zY3JpcHRzL3V0aWxzL2NvbnN0YW50cy5qcyc7XHJcblxyXG5pbXBvcnQgU2VjdGlvbiBmcm9tICcuLi8uLi9zY3JpcHRzL2NvbXBvbmVudHMvU2VjdGlvbi5qcyc7XHJcbmltcG9ydCBDYXJkIGZyb20gJy4uLy4uL3NjcmlwdHMvY29tcG9uZW50cy9DYXJkLmpzJztcclxuaW1wb3J0IFBvcHVwV2l0aEltYWdlIGZyb20gJy4uLy4uL3NjcmlwdHMvY29tcG9uZW50cy9Qb3B1cFdpdGhJbWFnZS5qcyc7XHJcbmltcG9ydCBQb3B1cFdpdGhGb3JtIGZyb20gJy4uLy4uL3NjcmlwdHMvY29tcG9uZW50cy9Qb3B1cFdpdGhGb3JtLmpzJztcclxuaW1wb3J0IFBvcHVwV2l0aENvbmZpcm1hdGlvbiBmcm9tICcuLi8uLi9zY3JpcHRzL2NvbXBvbmVudHMvUG9wdXBXaXRoQ29uZmlybWF0aW9uLmpzJztcclxuaW1wb3J0IFVzZXJJbmZvIGZyb20gJy4uLy4uL3NjcmlwdHMvY29tcG9uZW50cy9Vc2VySW5mby5qcyc7XHJcbmltcG9ydCBGb3JtVmFsaWRhdG9yIGZyb20gJy4uLy4uL3NjcmlwdHMvY29tcG9uZW50cy9Gb3JtVmFsaWRhdG9yLmpzJztcclxuaW1wb3J0IEFwaSBmcm9tICcuLi8uLi9zY3JpcHRzL2NvbXBvbmVudHMvQXBpLmpzJztcclxuXHJcbi8vIFN5bmNcclxuXHJcbi8vIENyZWF0ZSBwb3B1cCB3aXRoIHRoZSBpbWFnZVxyXG5cclxuY29uc3QgcG9wdXBFbmxhcmdpbmcgPSBuZXcgUG9wdXBXaXRoSW1hZ2UoJy5wb3B1cF90eXBlX2VubGFyZ2UnKTtcclxucG9wdXBFbmxhcmdpbmcuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuXHJcbi8vIENyZWF0ZSBwb3B1cCB3aXRoIHRoZSBzdWJtaXRcclxuXHJcbmNvbnN0IHBvcHVwU3VibWl0aW5nID0gbmV3IFBvcHVwV2l0aENvbmZpcm1hdGlvbignLnBvcHVwX3R5cGVfc3VibWl0Jyk7XHJcbnBvcHVwU3VibWl0aW5nLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcblxyXG4vLyBGdW5jdGlvbiB0byBjaGFuZ2UgdGhlIHN1Ym1pdCBidXR0b24gdGV4dCB3aGVuIHRvIHJlcXVlc3QgdG8gdGhlIHNlcnZlclxyXG5cclxuZnVuY3Rpb24gZ2V0U3VibWl0QnV0dG9uSW5pdGlhbFRleHQocG9wdXApIHtcclxuICBjb25zdCBzdWJtaXRCdXR0b24gPSBwb3B1cC5nZXRTdWJtaXRCdXR0b24oKTtcclxuICBjb25zdCBpbml0aWFsVGV4dCA9IHN1Ym1pdEJ1dHRvbi50ZXh0Q29udGVudDtcclxuXHJcbiAgcmV0dXJuIHsgc3VibWl0QnV0dG9uLCBpbml0aWFsVGV4dCB9O1xyXG59XHJcblxyXG5mdW5jdGlvbiBjaGFuZ2VTdWJtaXRCdXR0b25UZXh0KHN0YXJ0RG93bmxvYWQsIHsgc3VibWl0QnV0dG9uLCBpbml0aWFsVGV4dCB9KSB7XHJcbiAgaWYgKHN0YXJ0RG93bmxvYWQpIHtcclxuICAgIHN1Ym1pdEJ1dHRvbi50ZXh0Q29udGVudCA9ICfQodC+0YXRgNCw0L3QtdC90LjQtS4uLic7XHJcbiAgfSBlbHNlIHtcclxuICAgIHN1Ym1pdEJ1dHRvbi50ZXh0Q29udGVudCA9IGluaXRpYWxUZXh0O1xyXG4gIH1cclxufVxyXG5cclxuLy8gQ3JlYXRlIHRoZSB1c2VyIGluZm8gY29udHJvbCBvYmplY3RcclxuXHJcbmNvbnN0IHVzZXJJbmZvID0gbmV3IFVzZXJJbmZvKHtcclxuICBuYW1lU2VsZWN0b3I6ICcucHJvZmlsZV9fbmFtZScsXHJcbiAgYWJvdXRTZWxlY3RvcjogJy5wcm9maWxlX19hYm91dCcsXHJcbiAgYXZhdGFyU2VsZWN0b3I6ICcucHJvZmlsZV9fcGhvdG8nLFxyXG59KTtcclxuXHJcbi8vIENvbmZpZ3VyZSBBcGlcclxuXHJcbmNvbnN0IGFwaSA9IG5ldyBBcGkoe1xyXG4gIGJhc2VVcmw6ICdodHRwczovL21lc3RvLm5vbW9yZXBhcnRpZXMuY28vdjEvY29ob3J0LTQxJyxcclxuICBoZWFkZXJzOiB7XHJcbiAgICBhdXRob3JpemF0aW9uOiAnYjZiZGU5YmUtODY3NC00ZWNhLTgxNzktMzAyZTBhNGUyYjZmJyxcclxuICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicsXHJcbiAgfSxcclxufSk7XHJcblxyXG4vLyBBc3luY2hcclxuXHJcbi8vIEdldCBpbml0aWFsIGRhdGEgZnJvbSB0aGUgc2VydmVyXHJcblxyXG5hcGlcclxuICAuZ2V0SW5pdGlhbERhdGEoKVxyXG4gIC50aGVuKChpbml0aWFsRGF0YSkgPT4ge1xyXG4gICAgY29uc3QgW3VzZXJEYXRhLCBpbml0aWFsQ2FyZHNEYXRhXSA9IGluaXRpYWxEYXRhO1xyXG5cclxuICAgIC8vIFNldCB1c2VyIGluZm9cclxuXHJcbiAgICB1c2VySW5mby5zZXRVc2VySW5mbyh1c2VyRGF0YSk7XHJcblxyXG4gICAgLy8gRnVuY3Rpb24gZm9yIGNoZWNraW5nIHRoZSBjYXJkIGZvciBsaWtlc1xyXG5cclxuICAgIGZ1bmN0aW9uIGNoZWNrTGlrZUNhcmQoaXRlbSkge1xyXG4gICAgICByZXR1cm4gaXRlbS5saWtlcy5zb21lKChsaWtlKSA9PiBsaWtlLl9pZCA9PT0gdXNlckRhdGEuX2lkKTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBGdW5jdGlvbiBmb3IgY3JlYXRpbmcgYSBjYXJkXHJcblxyXG4gICAgZnVuY3Rpb24gY3JlYXRlQ2FyZChpdGVtKSB7XHJcbiAgICAgIGNvbnN0IGNhcmRFbGVtZW50ID0gbmV3IENhcmQoXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgZGF0YTogaXRlbSxcclxuICAgICAgICAgIGhhbmRsZUNhcmRDbGljazogKCkgPT4ge1xyXG4gICAgICAgICAgICBwb3B1cEVubGFyZ2luZy5vcGVuKGl0ZW0pO1xyXG4gICAgICAgICAgfSxcclxuICAgICAgICAgIGhhbmRsZUxpa2VDbGljazogKCkgPT4ge1xyXG4gICAgICAgICAgICAvLyBGdW5jdGlvbiBmb3IgdXBkYXRpbmcgY291bnRlciBhZnRlciBjaGFuZ2luZyB0aGUgbGlrZVxyXG5cclxuICAgICAgICAgICAgZnVuY3Rpb24gdXBkYXRl0KFvdW50ZXIoY2FyZERhdGEpIHtcclxuICAgICAgICAgICAgICBpZiAoY2FyZERhdGEpIHtcclxuICAgICAgICAgICAgICAgIGNhcmRFbGVtZW50LnVwZGF0ZdChb3VudGVyKGNhcmREYXRhLmxpa2VzLmxlbmd0aCk7XHJcbiAgICAgICAgICAgICAgICBpdGVtLmxpa2VzID0gY2FyZERhdGEubGlrZXM7XHJcbiAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdCgn0KHRh9C10YLRh9C40Log0LvQsNC50LrQvtCyINC90LUg0L7QsdC90L7QstC70LXQvScpO1xyXG4gICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgLy8gRGVsZXRlIGEgbGlrZSwgaWYgdGhlcmUgaXMgb25lLCBvdGhlcndpc2UgcHV0IHRoZSBsaWtlXHJcblxyXG4gICAgICAgICAgICBpZiAoY2hlY2tMaWtlQ2FyZChpdGVtKSkge1xyXG4gICAgICAgICAgICAgIGFwaVxyXG4gICAgICAgICAgICAgICAgLmRlbGV0ZUxpa2UoaXRlbS5faWQpXHJcbiAgICAgICAgICAgICAgICAudGhlbigoY2FyZERhdGEpID0+IHtcclxuICAgICAgICAgICAgICAgICAgY2FyZEVsZW1lbnQuZGVsZXRlTGlrZSgpO1xyXG4gICAgICAgICAgICAgICAgICByZXR1cm4gY2FyZERhdGE7XHJcbiAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgLnRoZW4oKGNhcmREYXRhKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgIHJldHVybiB1cGRhdGXQoW91bnRlcihjYXJkRGF0YSk7XHJcbiAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgLmNhdGNoKChlcnJvcikgPT4gY29uc29sZS5sb2coYNCe0YjQuNCx0LrQsDogJHtlcnJvcn1gKSk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgYXBpXHJcbiAgICAgICAgICAgICAgICAucHV0TGlrZShpdGVtLl9pZClcclxuICAgICAgICAgICAgICAgIC50aGVuKChjYXJkRGF0YSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICBjYXJkRWxlbWVudC5wdXRMaWtlKCk7XHJcbiAgICAgICAgICAgICAgICAgIHJldHVybiBjYXJkRGF0YTtcclxuICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAudGhlbigocmVzKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgIHJldHVybiB1cGRhdGXQoW91bnRlcihyZXMpO1xyXG4gICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgIC5jYXRjaCgoZXJyb3IpID0+IGNvbnNvbGUubG9nKGDQntGI0LjQsdC60LA6ICR7ZXJyb3J9YCkpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICB9LFxyXG4gICAgICAgICAgaGFuZGxlRGVsZXRlQnV0dG9uQ2xpY2s6ICgpID0+IHtcclxuICAgICAgICAgICAgcG9wdXBTdWJtaXRpbmcuc2V0SGFuZGxlcigoKSA9PiB7XHJcbiAgICAgICAgICAgICAgYXBpXHJcbiAgICAgICAgICAgICAgICAuZGVsZXRlQ2FyZChpdGVtLl9pZClcclxuICAgICAgICAgICAgICAgIC50aGVuKCgpID0+IHtcclxuICAgICAgICAgICAgICAgICAgY2FyZEVsZW1lbnQuZGVsZXRlQ2FyZCgpO1xyXG4gICAgICAgICAgICAgICAgICBwb3B1cFN1Ym1pdGluZy5jbG9zZSgpO1xyXG4gICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgIC5jYXRjaCgoZXJyb3IpID0+IGNvbnNvbGUubG9nKGDQntGI0LjQsdC60LA6ICR7ZXJyb3J9YCkpO1xyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIHBvcHVwU3VibWl0aW5nLm9wZW4oKTtcclxuICAgICAgICAgIH0sXHJcbiAgICAgICAgfSxcclxuICAgICAgICAnLnBsYWNlLXRlbXBsYXRlJ1xyXG4gICAgICApO1xyXG5cclxuICAgICAgcmV0dXJuIGNhcmRFbGVtZW50O1xyXG4gICAgfVxyXG5cclxuICAgIC8vIFJlbmRlciBpbml0aWFsIGNhcmRzXHJcblxyXG4gICAgY29uc3QgY2FyZExpc3QgPSBuZXcgU2VjdGlvbihcclxuICAgICAge1xyXG4gICAgICAgIGl0ZW1zOiBpbml0aWFsQ2FyZHNEYXRhLnJldmVyc2UoKSxcclxuICAgICAgICByZW5kZXI6IChpdGVtKSA9PiB7XHJcbiAgICAgICAgICAvLyBjaGVjayBhIGNhcmQgb3duZXIgYW5kIHVzZXIncyBsaWtlXHJcblxyXG4gICAgICAgICAgY29uc3QgaXNOb3RVc2VyQ2FyZCA9IGl0ZW0ub3duZXIuX2lkID09PSB1c2VyRGF0YS5faWQgPyBmYWxzZSA6IHRydWU7XHJcbiAgICAgICAgICBjb25zdCBpc0xpa2VkQnlVc2VyID0gY2hlY2tMaWtlQ2FyZChpdGVtKTtcclxuXHJcbiAgICAgICAgICBjb25zdCBjYXJkRWxlbWVudCA9IGNyZWF0ZUNhcmQoaXRlbSkuZ2VuZXJhdGVDYXJkKHsgaXNOb3RVc2VyQ2FyZCwgaXNMaWtlZEJ5VXNlciB9KTtcclxuICAgICAgICAgIGNhcmRMaXN0LmFkZEl0ZW0oY2FyZEVsZW1lbnQpO1xyXG4gICAgICAgIH0sXHJcbiAgICAgIH0sXHJcbiAgICAgIGNhcmRzU2VsZWN0b3JcclxuICAgICk7XHJcbiAgICBjYXJkTGlzdC5yZW5kZXJJdGVtcygpO1xyXG5cclxuICAgIHJldHVybiB7IHVzZXJEYXRhLCBpbml0aWFsQ2FyZHNEYXRhLCBjYXJkTGlzdCB9O1xyXG4gIH0pXHJcblxyXG4gIC50aGVuKChkYXRhT2JqZWN0KSA9PiB7XHJcbiAgICAvLyBGdW5jdGlvbiB0byBzdGFydCB2YWxpZGF0aW9uXHJcblxyXG4gICAgZnVuY3Rpb24gZW5hYmxlVmFsaWRhdGlvbihjb25maWcpIHtcclxuICAgICAgZm9ybUxpc3QuZm9yRWFjaCgoZm9ybUVsZW1lbnQpID0+IHtcclxuICAgICAgICBjb25zdCB2YWxpZGF0b3IgPSBuZXcgRm9ybVZhbGlkYXRvcihjb25maWcsIGZvcm1FbGVtZW50KTtcclxuICAgICAgICBjb25zdCBmb3JtTmFtZSA9IGZvcm1FbGVtZW50LmdldEF0dHJpYnV0ZSgnbmFtZScpO1xyXG5cclxuICAgICAgICBmb3JtVmFsaWRhdG9yc1tmb3JtTmFtZV0gPSB2YWxpZGF0b3I7XHJcblxyXG4gICAgICAgIHZhbGlkYXRvci5lbmFibGVWYWxpZGF0aW9uKCk7XHJcbiAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIFN0YXJ0IGZvcm0gdmFsaWRhdGlvblxyXG5cclxuICAgIGVuYWJsZVZhbGlkYXRpb24oY29uZmlnKTtcclxuXHJcbiAgICByZXR1cm4gZGF0YU9iamVjdDtcclxuICB9KVxyXG5cclxuICAudGhlbigoZGF0YU9iamVjdCkgPT4ge1xyXG4gICAgLy8gQ3JlYXRlIGEgcG9wdXAgZm9yIGVkaXRpbmdcclxuXHJcbiAgICBjb25zdCBwb3B1cEVkaXRpbmcgPSBuZXcgUG9wdXBXaXRoRm9ybSgnLnBvcHVwX3R5cGVfZWRpdCcsIChpbnB1dFZhbHVlcykgPT4ge1xyXG4gICAgICAvLyBNYW5hZ2Ugc3VibWl0IGJ1dHRvbiB0ZXh0XHJcblxyXG4gICAgICBjb25zdCBpbml0aWFsVGV4dCA9IGdldFN1Ym1pdEJ1dHRvbkluaXRpYWxUZXh0KHBvcHVwRWRpdGluZyk7XHJcbiAgICAgIGNoYW5nZVN1Ym1pdEJ1dHRvblRleHQodHJ1ZSwgaW5pdGlhbFRleHQpO1xyXG5cclxuICAgICAgLy8gRWRpdCB1c2VyIGluZm9cclxuXHJcbiAgICAgIGFwaVxyXG4gICAgICAgIC5lZGl0VXNlckluZm8oaW5wdXRWYWx1ZXMpXHJcbiAgICAgICAgLnRoZW4oKHVzZXJEYXRhKSA9PiB7XHJcbiAgICAgICAgICB1c2VySW5mby5zZXRVc2VySW5mbyh1c2VyRGF0YSk7XHJcbiAgICAgICAgfSlcclxuICAgICAgICAudGhlbigoKSA9PiB7XHJcbiAgICAgICAgICBwb3B1cEVkaXRpbmcuY2xvc2UoKTtcclxuICAgICAgICB9KVxyXG4gICAgICAgIC5jYXRjaCgoZXJyb3IpID0+IGNvbnNvbGUubG9nKGDQntGI0LjQsdC60LA6ICR7ZXJyb3J9YCkpXHJcbiAgICAgICAgLmZpbmFsbHkoKCkgPT4ge1xyXG4gICAgICAgICAgY2hhbmdlU3VibWl0QnV0dG9uVGV4dChmYWxzZSwgaW5pdGlhbFRleHQpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfSk7XHJcblxyXG4gICAgcG9wdXBFZGl0aW5nLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcblxyXG4gICAgLy8gQWRkIGxpc3RlbmVycyB0byBvcGVuIHRoZSBwb3B1cCBmb3IgZWRpdGluZ1xyXG5cclxuICAgIGZ1bmN0aW9uIGhhbmRsZUVkaXRCdXR0b24oKSB7XHJcbiAgICAgIHBvcHVwRWRpdGluZy5zZXRJbnB1dFZhbHVlcyh1c2VySW5mby5nZXRVc2VySW5mbygpKTtcclxuICAgICAgZm9ybVZhbGlkYXRvcnNbJ2VkaXQnXS5yZXNldFZhbGlkYXRpb24oKTtcclxuICAgICAgcG9wdXBFZGl0aW5nLm9wZW4oKTtcclxuICAgIH1cclxuXHJcbiAgICBidXR0b25Gb3JFZGl0aW5nUHJvZmlsZS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGhhbmRsZUVkaXRCdXR0b24pO1xyXG5cclxuICAgIHJldHVybiBkYXRhT2JqZWN0O1xyXG4gIH0pXHJcblxyXG4gIC50aGVuKChkYXRhT2JqZWN0KSA9PiB7XHJcbiAgICAvLyBDcmVhdGUgYSBwb3B1cCBmb3IgYWRkaW5nXHJcblxyXG4gICAgY29uc3QgcG9wdXBBZGRpbmcgPSBuZXcgUG9wdXBXaXRoRm9ybSgnLnBvcHVwX3R5cGVfYWRkJywgKGlucHV0VmFsdWVzKSA9PiB7XHJcbiAgICAgIC8vIE1hbmFnZSBzdWJtaXQgYnV0dG9uIHRleHRcclxuXHJcbiAgICAgIGNvbnN0IGluaXRpYWxUZXh0ID0gZ2V0U3VibWl0QnV0dG9uSW5pdGlhbFRleHQocG9wdXBBZGRpbmcpO1xyXG4gICAgICBjaGFuZ2VTdWJtaXRCdXR0b25UZXh0KHRydWUsIGluaXRpYWxUZXh0KTtcclxuXHJcbiAgICAgIC8vIEdldCBkYXRhIGZyb20gcG9wdXAgYWRkaW5nXHJcblxyXG4gICAgICBjb25zdCBkYXRhID0ge1xyXG4gICAgICAgIG5hbWU6IGlucHV0VmFsdWVzLnBsYWNlLFxyXG4gICAgICAgIGxpbms6IGlucHV0VmFsdWVzLmxpbmssXHJcbiAgICAgIH07XHJcblxyXG4gICAgICAvLyBBZGQgYSBuZXcgY2FyZFxyXG5cclxuICAgICAgYXBpXHJcbiAgICAgICAgLmFkZE5ld0NhcmQoZGF0YSlcclxuICAgICAgICAudGhlbigoZGF0YSkgPT4ge1xyXG4gICAgICAgICAgZGF0YU9iamVjdC5jYXJkTGlzdC5yZW5kZXJPbmVJdGVtKGRhdGEpO1xyXG4gICAgICAgIH0pXHJcbiAgICAgICAgLnRoZW4oKCkgPT4ge1xyXG4gICAgICAgICAgcG9wdXBBZGRpbmcuY2xvc2UoKTtcclxuICAgICAgICB9KVxyXG4gICAgICAgIC5jYXRjaCgoZXJyb3IpID0+IGNvbnNvbGUubG9nKGDQntGI0LjQsdC60LA6ICR7ZXJyb3J9YCkpXHJcbiAgICAgICAgLmZpbmFsbHkoKCkgPT4ge1xyXG4gICAgICAgICAgY2hhbmdlU3VibWl0QnV0dG9uVGV4dChmYWxzZSwgaW5pdGlhbFRleHQpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfSk7XHJcblxyXG4gICAgcG9wdXBBZGRpbmcuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuXHJcbiAgICAvLyBBZGQgbGlzdGVuZXJzIHRvIG9wZW4gdGhlIHBvcHVwIGZvciBhZGRpbmdcclxuXHJcbiAgICBmdW5jdGlvbiBoYW5kbGVCdXR0b25Gb3JBZGRpbmdDYXJkKCkge1xyXG4gICAgICBmb3JtVmFsaWRhdG9yc1snYWRkJ10ucmVzZXRWYWxpZGF0aW9uKCk7XHJcbiAgICAgIHBvcHVwQWRkaW5nLm9wZW4oKTtcclxuICAgIH1cclxuXHJcbiAgICBidXR0b25Gb3JBZGRpbmdDYXJkLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgaGFuZGxlQnV0dG9uRm9yQWRkaW5nQ2FyZCk7XHJcblxyXG4gICAgcmV0dXJuIGRhdGFPYmplY3Q7XHJcbiAgfSlcclxuXHJcbiAgLnRoZW4oKGRhdGFPYmplY3QpID0+IHtcclxuICAgIC8vIENyZWF0ZSBhIHBvcHVwIHRvIHVwZGF0ZSBhdmF0YXJcclxuXHJcbiAgICBjb25zdCBwb3B1cFVwZGF0aW5nQXZhdGFyID0gbmV3IFBvcHVwV2l0aEZvcm0oJy5wb3B1cF90eXBlX3VwZGF0ZS1hdmF0YXInLCAoaW5wdXRWYWx1ZXMpID0+IHtcclxuICAgICAgLy8gTWFuYWdlIHN1Ym1pdCBidXR0b24gdGV4dFxyXG5cclxuICAgICAgY29uc3QgaW5pdGlhbFRleHQgPSBnZXRTdWJtaXRCdXR0b25Jbml0aWFsVGV4dChwb3B1cFVwZGF0aW5nQXZhdGFyKTtcclxuICAgICAgY2hhbmdlU3VibWl0QnV0dG9uVGV4dCh0cnVlLCBpbml0aWFsVGV4dCk7XHJcblxyXG4gICAgICBjb25zdCBkYXRhID0ge1xyXG4gICAgICAgIGF2YXRhcjogaW5wdXRWYWx1ZXNbJ2F2YXRhci1saW5rJ10sXHJcbiAgICAgIH07XHJcblxyXG4gICAgICAvLyBVcGRhdGUgYXZhdGFyXHJcblxyXG4gICAgICBhcGlcclxuICAgICAgICAudXBkYXRlQXZhdGFyKGRhdGEpXHJcbiAgICAgICAgLnRoZW4oKHVzZXJEYXRhKSA9PiB7XHJcbiAgICAgICAgICB1c2VySW5mby5zZXRVc2VySW5mbyh1c2VyRGF0YSk7XHJcbiAgICAgICAgfSlcclxuICAgICAgICAudGhlbigoKSA9PiB7XHJcbiAgICAgICAgICBwb3B1cFVwZGF0aW5nQXZhdGFyLmNsb3NlKCk7XHJcbiAgICAgICAgfSlcclxuICAgICAgICAuY2F0Y2goKGVycm9yKSA9PiBjb25zb2xlLmxvZyhg0J7RiNC40LHQutCwOiAke2Vycm9yfWApKVxyXG4gICAgICAgIC5maW5hbGx5KCgpID0+IHtcclxuICAgICAgICAgIGNoYW5nZVN1Ym1pdEJ1dHRvblRleHQoZmFsc2UsIGluaXRpYWxUZXh0KTtcclxuICAgICAgICB9KTtcclxuICAgIH0pO1xyXG5cclxuICAgIHBvcHVwVXBkYXRpbmdBdmF0YXIuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuXHJcbiAgICAvLyBBZGQgbGlzdGVuZXJzIHRvIG9wZW4gdGhlIHBvcHVwIGZvciBhZGRpbmdcclxuXHJcbiAgICBmdW5jdGlvbiBoYW5kbGVCdXR0b25Gb3JVcGRhdGluZ0F2YXRhcigpIHtcclxuICAgICAgZm9ybVZhbGlkYXRvcnNbJ3VwZGF0ZS1hdmF0YXInXS5yZXNldFZhbGlkYXRpb24oKTtcclxuICAgICAgcG9wdXBVcGRhdGluZ0F2YXRhci5vcGVuKCk7XHJcbiAgICB9XHJcblxyXG4gICAgYnV0dG9uRm9yVXBkYXRpbmdBdmF0YXIuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBoYW5kbGVCdXR0b25Gb3JVcGRhdGluZ0F2YXRhcik7XHJcblxyXG4gICAgcmV0dXJuIGRhdGFPYmplY3Q7XHJcbiAgfSlcclxuXHJcbiAgLmNhdGNoKChlcnJvcikgPT4gY29uc29sZS5sb2coYNCe0YjQuNCx0LrQsDogJHtlcnJvcn1gKSk7XHJcbiJdLCJuYW1lcyI6WyJwcm9maWxlIiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwiYnV0dG9uRm9yRWRpdGluZ1Byb2ZpbGUiLCJidXR0b25Gb3JBZGRpbmdDYXJkIiwiYnV0dG9uRm9yVXBkYXRpbmdBdmF0YXIiLCJjb25maWciLCJpbnB1dFNlbGVjdG9yIiwiaW5wdXRFcnJvckNsYXNzIiwiZXJyb3JTZWxlY3RvciIsImVycm9yQ2xhc3MiLCJzdWJtaXRCdXR0b25TZWxlY3RvciIsImluYWN0aXZlQnV0dG9uQ2xhc3MiLCJmb3JtVmFsaWRhdG9ycyIsImZvcm1MaXN0IiwiQXJyYXkiLCJmcm9tIiwiZm9ybXMiLCJTZWN0aW9uIiwiY29udGFpbmVyU2VsZWN0b3IiLCJpdGVtcyIsInJlbmRlciIsInRoaXMiLCJfaXRlbXMiLCJfcmVuZGVyZXIiLCJfY29udGFpbmVyIiwiZm9yRWFjaCIsIml0ZW0iLCJlbGVtZW50IiwicHJlcGVuZCIsIkNhcmQiLCJjYXJkU2VsZWN0b3IiLCJkYXRhIiwiaGFuZGxlQ2FyZENsaWNrIiwiaGFuZGxlTGlrZUNsaWNrIiwiaGFuZGxlRGVsZXRlQnV0dG9uQ2xpY2siLCJfZGF0YSIsIl90aXRsZSIsIm5hbWUiLCJfbGluayIsImxpbmsiLCJfbGlrZXMiLCJsaWtlcyIsImxlbmd0aCIsIl9pZCIsIl9vd25lcklkIiwib3duZXIiLCJfYWx0IiwiX2hhbmRsZUNhcmRDbGljayIsIl9oYW5kbGVMaWtlQ2xpY2siLCJfaGFuZGxlRGVsZXRlQnV0dG9uQ2xpY2siLCJfY2FyZFNlbGVjdG9yIiwiY29udGVudCIsImNsb25lTm9kZSIsImlzTm90VXNlckNhcmQiLCJfZGVsZXRlQnV0dG9uIiwicmVtb3ZlIiwiaXNMaWtlZEJ5VXNlciIsInB1dExpa2UiLCJjaGXRgWtzIiwiX2VsZW1lbnQiLCJfZ2V0VGVtcGxhdGUiLCJfbGlrZUJ1dHRvbiIsIl9lbmxhcmdlQnV0dG9uIiwiX2NhcmRMaWtlcyIsImNhcmRUaXRsZSIsImNhcmRJbWFnZSIsInRleHRDb250ZW50Iiwic3JjIiwiYWx0IiwiX3NldEV2ZW50TGlzdGVuZXJzIiwiX2NoZWNrQ2FyZCIsIl9jaGVja0xpa2UiLCJhZGRFdmVudExpc3RlbmVyIiwiY2xhc3NMaXN0IiwiYWRkIiwiUG9wdXAiLCJwb3B1cFNlbGVjdG9yIiwiX3BvcHVwU2VsZWN0b3IiLCJfcG9wdXAiLCJfb3BlblBvcHVwU2VsZWN0b3IiLCJfaGFuZGxlRXNjQ2xvc2UiLCJiaW5kIiwiZXZlbnQiLCJrZXkiLCJjbG9zZSIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJ0YXJnZXQiLCJjdXJyZW50VGFyZ2V0IiwiY29udGFpbnMiLCJfaGFuZGxlQ2xpY2tDbG9zZSIsIlBvcHVwV2l0aEltYWdlIiwiX3BvcHVwSW1hZ2UiLCJfcG9wdXBJbWFnZUNhcHRpb24iLCJQb3B1cFdpdGhGb3JtIiwiaGFuZGxlRm9ybVN1Ym1pdCIsIl9oYW5kbGVTdWJtaXRGb3JtIiwiX2Zvcm1FbGVtZW50IiwiX2lucHV0TGlzdCIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJfc3VibWl0QnV0dG9uRWxlbWVudCIsInJlc2V0IiwiX2Zvcm1WYWx1ZXMiLCJpbnB1dCIsInZhbHVlIiwicHJldmVudERlZmF1bHQiLCJfZ2V0SW5wdXRWYWx1ZXMiLCJQb3B1cFdpdGhDb25maXJtYXRpb24iLCJfaGFuZGxlQ2xpY2tTdWJtaXQiLCJoYW5kbGVyIiwiVXNlckluZm8iLCJuYW1lU2VsZWN0b3IiLCJhYm91dFNlbGVjdG9yIiwiYXZhdGFyU2VsZWN0b3IiLCJfbmFtZSIsIl9hYm91dCIsIl9hdmF0YXIiLCJhYm91dCIsImF2YXRhciIsInVzZXJEYXRhIiwiRm9ybVZhbGlkYXRvciIsImZvcm1FbGVtZW50IiwiX2lucHV0U2VsZWN0b3IiLCJfaW5wdXRFcnJvckNsYXNzIiwiX2Vycm9yU2VsZWN0b3IiLCJfZXJyb3JDbGFzcyIsIl9zdWJtaXRCdXR0b25TZWxlY3RvciIsIl9pbmFjdGl2ZUJ1dHRvbkNsYXNzIiwiX2J1dHRvbkVsZW1lbnQiLCJpbnB1dEVsZW1lbnQiLCJfaXNWYWxpZCIsIl90b2dnbGVCdXR0b25TdGF0ZSIsInZhbGlkaXR5IiwidmFsaWQiLCJfaGlkZUlucHV0RXJyb3IiLCJfc2hvd0lucHV0RXJyb3IiLCJ2YWxpZGF0aW9uTWVzc2FnZSIsImVycm9yTWVzc2FnZSIsImVycm9yRWxlbWVudCIsImlkIiwiX2hhc0ludmFsaWRJbnB1dCIsIl9kaXNhYmxlQnV0dG9uIiwiX2VuYWJsZUJ1dHRvbiIsInNvbWUiLCJzZXRBdHRyaWJ1dGUiLCJyZW1vdmVBdHRyaWJ1dGUiLCJBcGkiLCJvcHRpb25zIiwiX3VybCIsImJhc2VVcmwiLCJfaGVhZGVycyIsImhlYWRlcnMiLCJyZXMiLCJlcnJvclRleHQiLCJvayIsImpzb24iLCJQcm9taXNlIiwicmVqZWN0IiwiZmV0Y2giLCJtZXRob2QiLCJ0aGVuIiwiX2hhbmRsZVJlc3BvbnNlIiwiYWxsIiwiZ2V0VXNlckluZm8iLCJnZXRJbml0aWFsQ2FyZHMiLCJib2R5IiwiSlNPTiIsInN0cmluZ2lmeSIsInBvcHVwRW5sYXJnaW5nIiwic2V0RXZlbnRMaXN0ZW5lcnMiLCJwb3B1cFN1Ym1pdGluZyIsImdldFN1Ym1pdEJ1dHRvbkluaXRpYWxUZXh0IiwicG9wdXAiLCJzdWJtaXRCdXR0b24iLCJnZXRTdWJtaXRCdXR0b24iLCJpbml0aWFsVGV4dCIsImNoYW5nZVN1Ym1pdEJ1dHRvblRleHQiLCJzdGFydERvd25sb2FkIiwidXNlckluZm8iLCJhcGkiLCJhdXRob3JpemF0aW9uIiwiZ2V0SW5pdGlhbERhdGEiLCJpbml0aWFsRGF0YSIsImluaXRpYWxDYXJkc0RhdGEiLCJjaGVja0xpa2VDYXJkIiwibGlrZSIsInNldFVzZXJJbmZvIiwiY2FyZExpc3QiLCJyZXZlcnNlIiwiY2FyZEVsZW1lbnQiLCJvcGVuIiwidXBkYXRl0KFvdW50ZXIiLCJjYXJkRGF0YSIsImRlbGV0ZUxpa2UiLCJjYXRjaCIsImVycm9yIiwiY29uc29sZSIsImxvZyIsInNldEhhbmRsZXIiLCJkZWxldGVDYXJkIiwiY3JlYXRlQ2FyZCIsImdlbmVyYXRlQ2FyZCIsImFkZEl0ZW0iLCJyZW5kZXJJdGVtcyIsImRhdGFPYmplY3QiLCJ2YWxpZGF0b3IiLCJmb3JtTmFtZSIsImdldEF0dHJpYnV0ZSIsImVuYWJsZVZhbGlkYXRpb24iLCJwb3B1cEVkaXRpbmciLCJpbnB1dFZhbHVlcyIsImVkaXRVc2VySW5mbyIsImZpbmFsbHkiLCJzZXRJbnB1dFZhbHVlcyIsInBvcHVwQWRkaW5nIiwicGxhY2UiLCJhZGROZXdDYXJkIiwicmVuZGVyT25lSXRlbSIsInBvcHVwVXBkYXRpbmdBdmF0YXIiLCJ1cGRhdGVBdmF0YXIiXSwic291cmNlUm9vdCI6IiJ9