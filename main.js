(()=>{"use strict";var e=document.querySelector(".profile"),t=e.querySelector(".profile__edit-button"),n=e.querySelector(".profile__add-button"),r=e.querySelector(".profile__update-button"),o={inputSelector:".popup__input",inputErrorClass:"popup__input_type_error",errorSelector:".popup__error",errorClass:"popup__error_active",submitButtonSelector:".popup__submit-button",inactiveButtonClass:"popup__submit-button_disabled"},i={},u=Array.from(document.forms),a="Сохранение...",c="Удаление...";function l(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var s=function(){function e(t,n){var r=t.items,o=t.render;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._items=r,this._renderer=o,this._container=document.querySelector(n)}var t,n;return t=e,(n=[{key:"renderItems",value:function(){var e=this;this._items.forEach((function(t){e._renderer(t)}))}},{key:"renderOneItem",value:function(e){this._renderer(e)}},{key:"addItem",value:function(e){this._container.prepend(e)}}])&&l(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function f(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var p=function(){function e(t,n){var r=t.data,o=t.handleCardClick,i=t.handleLikeClick,u=t.handleDeleteButtonClick;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._data=r,this._title=this._data.name,this._link=this._data.link,this._likes=this._data.likes.length,this._id=this._data._id,this._ownerId=this._data.owner._id,this._alt=this._title,this._handleCardClick=o,this._handleLikeClick=i,this._handleDeleteButtonClick=u,this._cardSelector=n}var t,n;return t=e,(n=[{key:"_getTemplate",value:function(){return document.querySelector(this._cardSelector).content.querySelector(".place").cloneNode(!0)}},{key:"_checkCard",value:function(e){e&&this._deleteButton.remove()}},{key:"_checkLike",value:function(e){e&&this.putLike()}},{key:"generateCard",value:function(e){this._element=this._getTemplate(),this._likeButton=this._element.querySelector(".place__like-button"),this._deleteButton=this._element.querySelector(".place__delete-button"),this._enlargeButton=this._element.querySelector(".place__enlarge-button"),this._cardLikes=this._element.querySelector(".place__like-counter");var t=this._element.querySelector(".place__title"),n=this._element.querySelector(".place__image");return t.textContent=this._title,n.src=this._link,n.alt=this._alt,this._cardLikes.textContent=this._likes,this._setEventListeners(),this._checkCard(e.isNotUserCard),this._checkLike(e.isLikedByUser),this._element}},{key:"_setEventListeners",value:function(){var e=this;this._likeButton.addEventListener("click",(function(){e._handleLikeClick()})),this._deleteButton&&this._deleteButton.addEventListener("click",(function(){e._handleDeleteButtonClick()})),this._enlargeButton.addEventListener("click",(function(){e._handleCardClick()}))}},{key:"deleteCard",value:function(){this._element.remove(),this._element=null}},{key:"putLike",value:function(){this._likeButton.classList.add("place__like-button_active")}},{key:"deleteLike",value:function(){this._likeButton.classList.remove("place__like-button_active")}},{key:"updateСounter",value:function(e){this._cardLikes.textContent=e}}])&&f(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function h(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var d=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._popupSelector=t,this._popup=document.querySelector(this._popupSelector),this._openPopupSelector="popup_opened",this._handleEscClose=this._handleEscClose.bind(this)}var t,n;return t=e,(n=[{key:"_handleEscClose",value:function(e){"Escape"===e.key&&this.close()}},{key:"open",value:function(){document.addEventListener("keydown",this._handleEscClose),this._popup.classList.add(this._openPopupSelector)}},{key:"close",value:function(){document.removeEventListener("keydown",this._handleEscClose),this._popup.classList.remove(this._openPopupSelector)}},{key:"_handleClickClose",value:function(e){(e.target===e.currentTarget||e.target.classList.contains("popup__close-button"))&&this.close()}},{key:"setEventListeners",value:function(){var e=this;this._popup.addEventListener("click",(function(t){e._handleClickClose(t)}))}}])&&h(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function _(e){return _="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_(e)}function y(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function v(){return v="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=b(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},v.apply(this,arguments)}function b(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=g(e)););return e}function m(e,t){return m=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},m(e,t)}function k(e,t){if(t&&("object"===_(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function g(e){return g=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},g(e)}var E=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&m(e,t)}(u,e);var t,n,r,o,i=(r=u,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=g(r);if(o){var n=g(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return k(this,e)});function u(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,u),(t=i.call(this,e))._popupImage=t._popup.querySelector(".popup__image"),t._popupImageCaption=t._popup.querySelector(".popup__image-caption"),t}return t=u,(n=[{key:"open",value:function(e){this._popupImageCaption.textContent=e.name,this._popupImage.src=e.link,this._popupImage.alt=this._popupImageCaption.textContent,v(g(u.prototype),"open",this).call(this)}}])&&y(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),u}(d);function S(e){return S="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},S(e)}function w(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function C(){return C="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=O(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},C.apply(this,arguments)}function O(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=P(e)););return e}function L(e,t){return L=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},L(e,t)}function j(e,t){if(t&&("object"===S(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function P(e){return P=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},P(e)}var B=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&L(e,t)}(u,e);var t,n,r,o,i=(r=u,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=P(r);if(o){var n=P(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return j(this,e)});function u(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,u),(n=i.call(this,e))._handleSubmitForm=t,n._formElement=n._popup.querySelector(".popup__form"),n._inputList=n._formElement.querySelectorAll(".popup__input"),n._submitButtonElement=n._popup.querySelector(".popup__submit-button"),n}return t=u,(n=[{key:"close",value:function(){C(P(u.prototype),"close",this).call(this),this._formElement.reset()}},{key:"_getInputValues",value:function(){var e=this;return this._formValues={},this._inputList.forEach((function(t){e._formValues[t.name]=t.value})),this._formValues}},{key:"setEventListeners",value:function(){var e=this;C(P(u.prototype),"setEventListeners",this).call(this),this._formElement.addEventListener("submit",(function(t){t.preventDefault(),e._handleSubmitForm(e._getInputValues())}))}},{key:"getPopupForm",value:function(){return this._formElement}},{key:"setInputValues",value:function(e){this._inputList.forEach((function(t){t.value=e[t.name]}))}},{key:"getSubmitButton",value:function(){return this._submitButtonElement}}])&&w(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),u}(d);function I(e){return I="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},I(e)}function R(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function T(){return T="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=q(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},T.apply(this,arguments)}function q(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=A(e)););return e}function x(e,t){return x=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},x(e,t)}function U(e,t){if(t&&("object"===I(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function A(e){return A=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},A(e)}var D=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&x(e,t)}(u,e);var t,n,r,o,i=(r=u,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=A(r);if(o){var n=A(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return U(this,e)});function u(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,u),(t=i.call(this,e))._handleClickSubmit={},t._submitButtonElement=t._popup.querySelector(".popup__submit-button"),t}return t=u,(n=[{key:"setHandler",value:function(e){this._handleClickSubmit=e}},{key:"setEventListeners",value:function(){var e=this;T(A(u.prototype),"setEventListeners",this).call(this),this._submitButtonElement.addEventListener("click",(function(){e._handleClickSubmit()}))}},{key:"getSubmitButton",value:function(){return this._submitButtonElement}}])&&R(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),u}(d);function V(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var N=function(){function e(t){var n=t.nameSelector,r=t.aboutSelector,o=t.avatarSelector;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._name=document.querySelector(n),this._about=document.querySelector(r),this._avatar=document.querySelector(o)}var t,n;return t=e,(n=[{key:"getUserInfo",value:function(){return{name:this._name.textContent,about:this._about.textContent,avatar:this._avatar.src}}},{key:"setUserInfo",value:function(e){this._name.textContent=e.name,this._about.textContent=e.about,this._avatar.src=e.avatar}}])&&V(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function H(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var F=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._inputSelector=t.inputSelector,this._inputErrorClass=t.inputErrorClass,this._errorSelector=t.errorSelector,this._errorClass=t.errorClass,this._submitButtonSelector=t.submitButtonSelector,this._inactiveButtonClass=t.inactiveButtonClass,this._formElement=n,this._inputList=Array.from(this._formElement.querySelectorAll(this._inputSelector)),this._buttonElement=this._formElement.querySelector(this._submitButtonSelector)}var t,n;return t=e,(n=[{key:"enableValidation",value:function(){this._setEventListeners()}},{key:"_setEventListeners",value:function(){var e=this;this._inputList.forEach((function(t){t.addEventListener("input",(function(){e._isValid(t),e._toggleButtonState()}))}))}},{key:"_isValid",value:function(e){e.validity.valid?this._hideInputError(e):this._showInputError(e,e.validationMessage)}},{key:"_showInputError",value:function(e,t){var n=this._formElement.querySelector(".".concat(e.id,"-error"));e.classList.add(this._inputErrorClass),n.textContent=t,n.classList.add(this._errorClass)}},{key:"_hideInputError",value:function(e){var t=this._formElement.querySelector(".".concat(e.id,"-error"));e.classList.remove(this._inputErrorClass),t.classList.remove(this._errorClass),t.textContent=""}},{key:"_toggleButtonState",value:function(){this._hasInvalidInput()?this._disableButton():this._enableButton()}},{key:"_hasInvalidInput",value:function(){return this._inputList.some((function(e){return!e.validity.valid}))}},{key:"_disableButton",value:function(){this._buttonElement.classList.add(this._inactiveButtonClass),this._buttonElement.setAttribute("disabled",!0)}},{key:"_enableButton",value:function(){this._buttonElement.removeAttribute("disabled"),this._buttonElement.classList.remove(this._inactiveButtonClass)}},{key:"resetValidation",value:function(){var e=this;this._toggleButtonState(),this._inputList.forEach((function(t){e._hideInputError(t)}))}}])&&H(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function J(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var G=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._url=t.baseUrl,this._headers=t.headers}var t,n;return t=e,(n=[{key:"_handleResponse",value:function(e,t){return e.ok?e.json():Promise.reject(t)}},{key:"getUserInfo",value:function(){var e=this;return fetch("".concat(this._url,"/users/me"),{method:"GET",headers:this._headers}).then((function(t){return e._handleResponse(t,"Данные пользователя не получены")}))}},{key:"getInitialCards",value:function(){var e=this;return fetch("".concat(this._url,"/cards"),{method:"GET",headers:this._headers}).then((function(t){return e._handleResponse(t,"Список карточек не получен")}))}},{key:"getInitialData",value:function(){return Promise.all([this.getUserInfo(),this.getInitialCards()])}},{key:"editUserInfo",value:function(e){var t=this;return fetch("".concat(this._url,"/users/me"),{method:"PATCH",headers:this._headers,body:JSON.stringify(e)}).then((function(e){return t._handleResponse(e,"Данные пользователя не изменены")}))}},{key:"addNewCard",value:function(e){var t=this;return fetch("".concat(this._url,"/cards"),{method:"POST",headers:this._headers,body:JSON.stringify(e)}).then((function(e){return t._handleResponse(e,"Карточка не добавлена")}))}},{key:"deleteCard",value:function(e){var t=this;return fetch("".concat(this._url,"/cards/").concat(e),{method:"DELETE",headers:this._headers}).then((function(e){return t._handleResponse(e,"Карточка не удалена")}))}},{key:"putLike",value:function(e){var t=this;return fetch("".concat(this._url,"/cards/").concat(e,"/likes"),{method:"PUT",headers:this._headers}).then((function(e){return t._handleResponse(e,"Лайк не добавлен")}))}},{key:"deleteLike",value:function(e){var t=this;return fetch("".concat(this._url,"/cards/").concat(e,"/likes"),{method:"DELETE",headers:this._headers}).then((function(e){return t._handleResponse(e,"Лайк не убран")}))}},{key:"updateAvatar",value:function(e){var t=this;return fetch("".concat(this._url,"/users/me/avatar"),{method:"PATCH",headers:this._headers,body:JSON.stringify(e)}).then((function(e){return t._handleResponse(e,"Аватар пользователя не изменен")}))}}])&&J(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function M(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var z=new E(".popup_type_enlarge");z.setEventListeners();var $=new D(".popup_type_submit");function K(e){return e.getSubmitButton().textContent}function Q(e,t,n,r){t.getSubmitButton().textContent=e?r:n}$.setEventListeners();var W=new N({nameSelector:".profile__name",aboutSelector:".profile__about",avatarSelector:".profile__photo"}),X=new G({baseUrl:"https://mesto.nomoreparties.co/v1/cohort-41",headers:{authorization:"b6bde9be-8674-4eca-8179-302e0a4e2b6f","Content-Type":"application/json"}});X.getInitialData().then((function(e){var t,n,r=(n=2,function(e){if(Array.isArray(e))return e}(t=e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],u=!0,a=!1;try{for(n=n.call(e);!(u=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);u=!0);}catch(e){a=!0,o=e}finally{try{u||null==n.return||n.return()}finally{if(a)throw o}}return i}}(t,n)||function(e,t){if(e){if("string"==typeof e)return M(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?M(e,t):void 0}}(t,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),o=r[0],i=r[1];function u(e){return e.likes.some((function(e){return e._id===o._id}))}W.setUserInfo(o);var a=new s({items:i.reverse(),render:function(e){var t=e.owner._id!==o._id,n=u(e),r=function(e){var t=new p({data:e,handleCardClick:function(){z.open(e)},handleLikeClick:function(){function n(n){t.updateСounter(n.likes.length),e.likes=n.likes}u(e)?X.deleteLike(e._id).then((function(e){t.deleteLike(),n(e)})).catch((function(e){return console.log("Ошибка: ".concat(e))})):X.putLike(e._id).then((function(e){t.putLike(),n(e)})).catch((function(e){return console.log("Ошибка: ".concat(e))}))},handleDeleteButtonClick:function(){$.setHandler((function(){var n=K($);Q(!0,$,n,c),X.deleteCard(e._id).then((function(){t.deleteCard(),$.close()})).catch((function(e){return console.log("Ошибка: ".concat(e))})).finally((function(){Q(!1,$,n,c)}))})),$.open()}},".place-template");return t}(e).generateCard({isNotUserCard:t,isLikedByUser:n});a.addItem(r)}},".places__list");return a.renderItems(),{userData:o,initialCardsData:i,cardList:a}})).then((function(e){return function(e){u.forEach((function(t){var n=new F(e,t),r=t.getAttribute("name");i[r]=n,n.enableValidation()}))}(o),e})).then((function(e){var n=new B(".popup_type_edit",(function(e){var t=K(n);Q(!0,n,t,a),X.editUserInfo(e).then((function(e){W.setUserInfo(e),n.close()})).catch((function(e){return console.log("Ошибка: ".concat(e))})).finally((function(){Q(!1,n,t,a)}))}));return n.setEventListeners(),t.addEventListener("click",(function(){n.setInputValues(W.getUserInfo()),i.edit.resetValidation(),n.open()})),e})).then((function(e){var t=new B(".popup_type_add",(function(n){var r=K(t);Q(!0,t,r,a);var o={name:n.place,link:n.link};X.addNewCard(o).then((function(n){e.cardList.renderOneItem(n),t.close()})).catch((function(e){return console.log("Ошибка: ".concat(e))})).finally((function(){Q(!1,t,r,a)}))}));return t.setEventListeners(),n.addEventListener("click",(function(){i.add.resetValidation(),t.open()})),e})).then((function(e){var t=new B(".popup_type_update-avatar",(function(e){var n=K(t);Q(!0,t,n,a);var r={avatar:e["avatar-link"]};X.updateAvatar(r).then((function(e){W.setUserInfo(e),t.close()})).catch((function(e){return console.log("Ошибка: ".concat(e))})).finally((function(){Q(!1,t,n,a)}))}));return t.setEventListeners(),r.addEventListener("click",(function(){i["update-avatar"].resetValidation(),t.open()})),e})).catch((function(e){return console.log("Ошибка: ".concat(e))}))})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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RyxFQUFvQnJJLFdBRXJCNkcsT0FBTSxTQUFDQyxHQUFELE9BQVdDLFFBQVFDLElBQVIsa0JBQXVCRixPQUN4Q0ssU0FBUSxXQUNQMUIsR0FBaUIsRUFBTzRDLEVBQXFCMUMsRUFBYWhLLFNBZWhFLE9BWEEwTSxFQUFvQmpELG9CQVNwQnRLLEVBQXdCc0UsaUJBQWlCLFNBTHpDLFdBQ0U5RCxFQUFlLGlCQUFmQSxrQkFDQStNLEVBQW9CNUIsVUFLZmUsS0FHUlgsT0FBTSxTQUFDQyxHQUFELE9BQVdDLFFBQVFDLElBQVIsa0JBQXVCRixRIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vbWVzdG8vLi9zcmMvc2NyaXB0cy91dGlscy9jb25zdGFudHMuanMiLCJ3ZWJwYWNrOi8vbWVzdG8vLi9zcmMvc2NyaXB0cy9jb21wb25lbnRzL1NlY3Rpb24uanMiLCJ3ZWJwYWNrOi8vbWVzdG8vLi9zcmMvc2NyaXB0cy9jb21wb25lbnRzL0NhcmQuanMiLCJ3ZWJwYWNrOi8vbWVzdG8vLi9zcmMvc2NyaXB0cy9jb21wb25lbnRzL1BvcHVwLmpzIiwid2VicGFjazovL21lc3RvLy4vc3JjL3NjcmlwdHMvY29tcG9uZW50cy9Qb3B1cFdpdGhJbWFnZS5qcyIsIndlYnBhY2s6Ly9tZXN0by8uL3NyYy9zY3JpcHRzL2NvbXBvbmVudHMvUG9wdXBXaXRoRm9ybS5qcyIsIndlYnBhY2s6Ly9tZXN0by8uL3NyYy9zY3JpcHRzL2NvbXBvbmVudHMvUG9wdXBXaXRoQ29uZmlybWF0aW9uLmpzIiwid2VicGFjazovL21lc3RvLy4vc3JjL3NjcmlwdHMvY29tcG9uZW50cy9Vc2VySW5mby5qcyIsIndlYnBhY2s6Ly9tZXN0by8uL3NyYy9zY3JpcHRzL2NvbXBvbmVudHMvRm9ybVZhbGlkYXRvci5qcyIsIndlYnBhY2s6Ly9tZXN0by8uL3NyYy9zY3JpcHRzL2NvbXBvbmVudHMvQXBpLmpzIiwid2VicGFjazovL21lc3RvLy4vc3JjL3BhZ2VzL2luZGV4L2luZGV4LmpzIl0sInNvdXJjZXNDb250ZW50IjpbImV4cG9ydCBjb25zdCBwcm9maWxlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnByb2ZpbGUnKTtcclxuZXhwb3J0IGNvbnN0IGJ1dHRvbkZvckVkaXRpbmdQcm9maWxlID0gcHJvZmlsZS5xdWVyeVNlbGVjdG9yKCcucHJvZmlsZV9fZWRpdC1idXR0b24nKTtcclxuZXhwb3J0IGNvbnN0IGJ1dHRvbkZvckFkZGluZ0NhcmQgPSBwcm9maWxlLnF1ZXJ5U2VsZWN0b3IoJy5wcm9maWxlX19hZGQtYnV0dG9uJyk7XHJcbmV4cG9ydCBjb25zdCBidXR0b25Gb3JVcGRhdGluZ0F2YXRhciA9IHByb2ZpbGUucXVlcnlTZWxlY3RvcignLnByb2ZpbGVfX3VwZGF0ZS1idXR0b24nKTtcclxuXHJcbmV4cG9ydCBjb25zdCBjYXJkc1NlbGVjdG9yID0gJy5wbGFjZXNfX2xpc3QnO1xyXG5cclxuZXhwb3J0IGNvbnN0IGNvbmZpZyA9IHtcclxuICBpbnB1dFNlbGVjdG9yOiAnLnBvcHVwX19pbnB1dCcsXHJcbiAgaW5wdXRFcnJvckNsYXNzOiAncG9wdXBfX2lucHV0X3R5cGVfZXJyb3InLFxyXG4gIGVycm9yU2VsZWN0b3I6ICcucG9wdXBfX2Vycm9yJyxcclxuICBlcnJvckNsYXNzOiAncG9wdXBfX2Vycm9yX2FjdGl2ZScsXHJcbiAgc3VibWl0QnV0dG9uU2VsZWN0b3I6ICcucG9wdXBfX3N1Ym1pdC1idXR0b24nLFxyXG4gIGluYWN0aXZlQnV0dG9uQ2xhc3M6ICdwb3B1cF9fc3VibWl0LWJ1dHRvbl9kaXNhYmxlZCcsXHJcbn07XHJcblxyXG5leHBvcnQgY29uc3QgZm9ybVZhbGlkYXRvcnMgPSB7fTtcclxuZXhwb3J0IGNvbnN0IGZvcm1MaXN0ID0gQXJyYXkuZnJvbShkb2N1bWVudC5mb3Jtcyk7XHJcblxyXG5leHBvcnQgY29uc3Qgc2F2ZVRleHQgPSAn0KHQvtGF0YDQsNC90LXQvdC40LUuLi4nO1xyXG5leHBvcnQgY29uc3QgZGVsZXRlVGV4dCA9ICfQo9C00LDQu9C10L3QuNC1Li4uJztcclxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgU2VjdGlvbiB7XHJcbiAgY29uc3RydWN0b3IoeyBpdGVtcywgcmVuZGVyIH0sIGNvbnRhaW5lclNlbGVjdG9yKSB7XHJcbiAgICB0aGlzLl9pdGVtcyA9IGl0ZW1zO1xyXG4gICAgdGhpcy5fcmVuZGVyZXIgPSByZW5kZXI7XHJcbiAgICB0aGlzLl9jb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGNvbnRhaW5lclNlbGVjdG9yKTtcclxuICB9XHJcblxyXG4gIHJlbmRlckl0ZW1zKCkge1xyXG4gICAgdGhpcy5faXRlbXMuZm9yRWFjaCgoaXRlbSkgPT4ge1xyXG4gICAgICB0aGlzLl9yZW5kZXJlcihpdGVtKTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgcmVuZGVyT25lSXRlbShpdGVtKSB7XHJcbiAgICB0aGlzLl9yZW5kZXJlcihpdGVtKTtcclxuICB9XHJcblxyXG4gIGFkZEl0ZW0oZWxlbWVudCkge1xyXG4gICAgdGhpcy5fY29udGFpbmVyLnByZXBlbmQoZWxlbWVudCk7XHJcbiAgfVxyXG59XHJcbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIENhcmQge1xyXG4gIGNvbnN0cnVjdG9yKHsgZGF0YSwgaGFuZGxlQ2FyZENsaWNrLCBoYW5kbGVMaWtlQ2xpY2ssIGhhbmRsZURlbGV0ZUJ1dHRvbkNsaWNrIH0sIGNhcmRTZWxlY3Rvcikge1xyXG4gICAgdGhpcy5fZGF0YSA9IGRhdGE7XHJcbiAgICB0aGlzLl90aXRsZSA9IHRoaXMuX2RhdGEubmFtZTtcclxuICAgIHRoaXMuX2xpbmsgPSB0aGlzLl9kYXRhLmxpbms7XHJcbiAgICB0aGlzLl9saWtlcyA9IHRoaXMuX2RhdGEubGlrZXMubGVuZ3RoO1xyXG4gICAgdGhpcy5faWQgPSB0aGlzLl9kYXRhLl9pZDtcclxuICAgIHRoaXMuX293bmVySWQgPSB0aGlzLl9kYXRhLm93bmVyLl9pZDtcclxuXHJcbiAgICB0aGlzLl9hbHQgPSB0aGlzLl90aXRsZTtcclxuXHJcbiAgICB0aGlzLl9oYW5kbGVDYXJkQ2xpY2sgPSBoYW5kbGVDYXJkQ2xpY2s7XHJcbiAgICB0aGlzLl9oYW5kbGVMaWtlQ2xpY2sgPSBoYW5kbGVMaWtlQ2xpY2s7XHJcbiAgICB0aGlzLl9oYW5kbGVEZWxldGVCdXR0b25DbGljayA9IGhhbmRsZURlbGV0ZUJ1dHRvbkNsaWNrO1xyXG4gICAgdGhpcy5fY2FyZFNlbGVjdG9yID0gY2FyZFNlbGVjdG9yO1xyXG4gIH1cclxuXHJcbiAgX2dldFRlbXBsYXRlKCkge1xyXG4gICAgY29uc3QgY2FyZEVsZW1lbnQgPSBkb2N1bWVudFxyXG4gICAgICAucXVlcnlTZWxlY3Rvcih0aGlzLl9jYXJkU2VsZWN0b3IpXHJcbiAgICAgIC5jb250ZW50LnF1ZXJ5U2VsZWN0b3IoJy5wbGFjZScpXHJcbiAgICAgIC5jbG9uZU5vZGUodHJ1ZSk7XHJcblxyXG4gICAgcmV0dXJuIGNhcmRFbGVtZW50O1xyXG4gIH1cclxuXHJcbiAgX2NoZWNrQ2FyZChpc05vdFVzZXJDYXJkKSB7XHJcbiAgICBpZiAoaXNOb3RVc2VyQ2FyZCkge1xyXG4gICAgICB0aGlzLl9kZWxldGVCdXR0b24ucmVtb3ZlKCk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBfY2hlY2tMaWtlKGlzTGlrZWRCeVVzZXIpIHtcclxuICAgIGlmIChpc0xpa2VkQnlVc2VyKSB7XHJcbiAgICAgIHRoaXMucHV0TGlrZSgpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgZ2VuZXJhdGVDYXJkKGNoZdGBa3MpIHtcclxuICAgIHRoaXMuX2VsZW1lbnQgPSB0aGlzLl9nZXRUZW1wbGF0ZSgpO1xyXG4gICAgdGhpcy5fbGlrZUJ1dHRvbiA9IHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcignLnBsYWNlX19saWtlLWJ1dHRvbicpO1xyXG4gICAgdGhpcy5fZGVsZXRlQnV0dG9uID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKCcucGxhY2VfX2RlbGV0ZS1idXR0b24nKTtcclxuICAgIHRoaXMuX2VubGFyZ2VCdXR0b24gPSB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wbGFjZV9fZW5sYXJnZS1idXR0b24nKTtcclxuICAgIHRoaXMuX2NhcmRMaWtlcyA9IHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcignLnBsYWNlX19saWtlLWNvdW50ZXInKTtcclxuXHJcbiAgICBjb25zdCBjYXJkVGl0bGUgPSB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wbGFjZV9fdGl0bGUnKTtcclxuICAgIGNvbnN0IGNhcmRJbWFnZSA9IHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcignLnBsYWNlX19pbWFnZScpO1xyXG5cclxuICAgIGNhcmRUaXRsZS50ZXh0Q29udGVudCA9IHRoaXMuX3RpdGxlO1xyXG4gICAgY2FyZEltYWdlLnNyYyA9IHRoaXMuX2xpbms7XHJcbiAgICBjYXJkSW1hZ2UuYWx0ID0gdGhpcy5fYWx0O1xyXG5cclxuICAgIHRoaXMuX2NhcmRMaWtlcy50ZXh0Q29udGVudCA9IHRoaXMuX2xpa2VzO1xyXG5cclxuICAgIHRoaXMuX3NldEV2ZW50TGlzdGVuZXJzKCk7XHJcblxyXG4gICAgdGhpcy5fY2hlY2tDYXJkKGNoZdGBa3MuaXNOb3RVc2VyQ2FyZCk7XHJcbiAgICB0aGlzLl9jaGVja0xpa2UoY2hl0YFrcy5pc0xpa2VkQnlVc2VyKTtcclxuXHJcbiAgICByZXR1cm4gdGhpcy5fZWxlbWVudDtcclxuICB9XHJcblxyXG4gIF9zZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgIHRoaXMuX2xpa2VCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XHJcbiAgICAgIHRoaXMuX2hhbmRsZUxpa2VDbGljaygpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgaWYgKHRoaXMuX2RlbGV0ZUJ1dHRvbikge1xyXG4gICAgICB0aGlzLl9kZWxldGVCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XHJcbiAgICAgICAgdGhpcy5faGFuZGxlRGVsZXRlQnV0dG9uQ2xpY2soKTtcclxuICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgdGhpcy5fZW5sYXJnZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcclxuICAgICAgdGhpcy5faGFuZGxlQ2FyZENsaWNrKCk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIGRlbGV0ZUNhcmQoKSB7XHJcbiAgICB0aGlzLl9lbGVtZW50LnJlbW92ZSgpO1xyXG4gICAgdGhpcy5fZWxlbWVudCA9IG51bGw7XHJcbiAgfVxyXG5cclxuICBwdXRMaWtlKCkge1xyXG4gICAgdGhpcy5fbGlrZUJ1dHRvbi5jbGFzc0xpc3QuYWRkKCdwbGFjZV9fbGlrZS1idXR0b25fYWN0aXZlJyk7XHJcbiAgfVxyXG5cclxuICBkZWxldGVMaWtlKCkge1xyXG4gICAgdGhpcy5fbGlrZUJ1dHRvbi5jbGFzc0xpc3QucmVtb3ZlKCdwbGFjZV9fbGlrZS1idXR0b25fYWN0aXZlJyk7XHJcbiAgfVxyXG5cclxuICB1cGRhdGXQoW91bnRlcihsaWtlcykge1xyXG4gICAgdGhpcy5fY2FyZExpa2VzLnRleHRDb250ZW50ID0gbGlrZXM7XHJcbiAgfVxyXG59XHJcbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwIHtcbiAgY29uc3RydWN0b3IocG9wdXBTZWxlY3Rvcikge1xuICAgIHRoaXMuX3BvcHVwU2VsZWN0b3IgPSBwb3B1cFNlbGVjdG9yO1xuICAgIHRoaXMuX3BvcHVwID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcih0aGlzLl9wb3B1cFNlbGVjdG9yKTtcbiAgICB0aGlzLl9vcGVuUG9wdXBTZWxlY3RvciA9ICdwb3B1cF9vcGVuZWQnO1xuICAgIHRoaXMuX2hhbmRsZUVzY0Nsb3NlID0gdGhpcy5faGFuZGxlRXNjQ2xvc2UuYmluZCh0aGlzKTtcbiAgfVxuXG4gIF9oYW5kbGVFc2NDbG9zZShldmVudCkge1xuICAgIGlmIChldmVudC5rZXkgPT09ICdFc2NhcGUnKSB7XG4gICAgICB0aGlzLmNsb3NlKCk7XG4gICAgfVxuICB9XG5cbiAgb3BlbigpIHtcbiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdrZXlkb3duJywgdGhpcy5faGFuZGxlRXNjQ2xvc2UpO1xuICAgIHRoaXMuX3BvcHVwLmNsYXNzTGlzdC5hZGQodGhpcy5fb3BlblBvcHVwU2VsZWN0b3IpO1xuICB9XG5cbiAgY2xvc2UoKSB7XG4gICAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIHRoaXMuX2hhbmRsZUVzY0Nsb3NlKTtcbiAgICB0aGlzLl9wb3B1cC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX29wZW5Qb3B1cFNlbGVjdG9yKTtcbiAgfVxuXG4gIF9oYW5kbGVDbGlja0Nsb3NlKGV2ZW50KSB7XG4gICAgaWYgKFxuICAgICAgZXZlbnQudGFyZ2V0ID09PSBldmVudC5jdXJyZW50VGFyZ2V0IHx8XG4gICAgICBldmVudC50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKCdwb3B1cF9fY2xvc2UtYnV0dG9uJylcbiAgICApIHtcbiAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICB9XG4gIH1cblxuICBzZXRFdmVudExpc3RlbmVycygpIHtcbiAgICB0aGlzLl9wb3B1cC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIChldmVudCkgPT4ge1xuICAgICAgdGhpcy5faGFuZGxlQ2xpY2tDbG9zZShldmVudCk7XG4gICAgfSk7XG4gIH1cbn1cbiIsImltcG9ydCBQb3B1cCBmcm9tICcuL1BvcHVwLmpzJztcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwV2l0aEltYWdlIGV4dGVuZHMgUG9wdXAge1xyXG4gIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IpIHtcclxuICAgIHN1cGVyKHBvcHVwU2VsZWN0b3IpO1xyXG4gICAgdGhpcy5fcG9wdXBJbWFnZSA9IHRoaXMuX3BvcHVwLnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF9faW1hZ2UnKTtcclxuICAgIHRoaXMuX3BvcHVwSW1hZ2VDYXB0aW9uID0gdGhpcy5fcG9wdXAucXVlcnlTZWxlY3RvcignLnBvcHVwX19pbWFnZS1jYXB0aW9uJyk7XHJcbiAgfVxyXG5cclxuICBvcGVuKGRhdGEpIHtcclxuICAgIHRoaXMuX3BvcHVwSW1hZ2VDYXB0aW9uLnRleHRDb250ZW50ID0gZGF0YS5uYW1lO1xyXG4gICAgdGhpcy5fcG9wdXBJbWFnZS5zcmMgPSBkYXRhLmxpbms7XHJcbiAgICB0aGlzLl9wb3B1cEltYWdlLmFsdCA9IHRoaXMuX3BvcHVwSW1hZ2VDYXB0aW9uLnRleHRDb250ZW50O1xyXG5cclxuICAgIHN1cGVyLm9wZW4oKTtcclxuICB9XHJcbn1cclxuIiwiaW1wb3J0IFBvcHVwIGZyb20gJy4vUG9wdXAuanMnO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXBXaXRoRm9ybSBleHRlbmRzIFBvcHVwIHtcclxuICBjb25zdHJ1Y3Rvcihwb3B1cFNlbGVjdG9yLCBoYW5kbGVGb3JtU3VibWl0KSB7XHJcbiAgICBzdXBlcihwb3B1cFNlbGVjdG9yKTtcclxuICAgIHRoaXMuX2hhbmRsZVN1Ym1pdEZvcm0gPSBoYW5kbGVGb3JtU3VibWl0O1xyXG4gICAgdGhpcy5fZm9ybUVsZW1lbnQgPSB0aGlzLl9wb3B1cC5xdWVyeVNlbGVjdG9yKCcucG9wdXBfX2Zvcm0nKTtcclxuICAgIHRoaXMuX2lucHV0TGlzdCA9IHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5wb3B1cF9faW5wdXQnKTtcclxuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbkVsZW1lbnQgPSB0aGlzLl9wb3B1cC5xdWVyeVNlbGVjdG9yKCcucG9wdXBfX3N1Ym1pdC1idXR0b24nKTtcclxuICB9XHJcblxyXG4gIGNsb3NlKCkge1xyXG4gICAgc3VwZXIuY2xvc2UoKTtcclxuICAgIHRoaXMuX2Zvcm1FbGVtZW50LnJlc2V0KCk7XHJcbiAgfVxyXG5cclxuICBfZ2V0SW5wdXRWYWx1ZXMoKSB7XHJcbiAgICB0aGlzLl9mb3JtVmFsdWVzID0ge307XHJcbiAgICB0aGlzLl9pbnB1dExpc3QuZm9yRWFjaCgoaW5wdXQpID0+IHtcclxuICAgICAgdGhpcy5fZm9ybVZhbHVlc1tpbnB1dC5uYW1lXSA9IGlucHV0LnZhbHVlO1xyXG4gICAgfSk7XHJcblxyXG4gICAgcmV0dXJuIHRoaXMuX2Zvcm1WYWx1ZXM7XHJcbiAgfVxyXG5cclxuICBzZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgIHN1cGVyLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcblxyXG4gICAgdGhpcy5fZm9ybUVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignc3VibWl0JywgKGV2ZW50KSA9PiB7XHJcbiAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgIHRoaXMuX2hhbmRsZVN1Ym1pdEZvcm0odGhpcy5fZ2V0SW5wdXRWYWx1ZXMoKSk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIGdldFBvcHVwRm9ybSgpIHtcclxuICAgIHJldHVybiB0aGlzLl9mb3JtRWxlbWVudDtcclxuICB9XHJcblxyXG4gIHNldElucHV0VmFsdWVzKGRhdGEpIHtcclxuICAgIHRoaXMuX2lucHV0TGlzdC5mb3JFYWNoKChpbnB1dCkgPT4ge1xyXG4gICAgICBpbnB1dC52YWx1ZSA9IGRhdGFbaW5wdXQubmFtZV07XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIGdldFN1Ym1pdEJ1dHRvbigpIHtcclxuICAgIHJldHVybiB0aGlzLl9zdWJtaXRCdXR0b25FbGVtZW50O1xyXG4gIH1cclxufVxyXG4iLCJpbXBvcnQgUG9wdXAgZnJvbSAnLi9Qb3B1cC5qcyc7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cFdpdGhDb25maXJtYXRpb24gZXh0ZW5kcyBQb3B1cCB7XHJcbiAgY29uc3RydWN0b3IocG9wdXBTZWxlY3Rvcikge1xyXG4gICAgc3VwZXIocG9wdXBTZWxlY3Rvcik7XHJcbiAgICB0aGlzLl9oYW5kbGVDbGlja1N1Ym1pdCA9IHt9O1xyXG4gICAgdGhpcy5fc3VibWl0QnV0dG9uRWxlbWVudCA9IHRoaXMuX3BvcHVwLnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF9fc3VibWl0LWJ1dHRvbicpO1xyXG4gIH1cclxuXHJcbiAgc2V0SGFuZGxlcihoYW5kbGVyKSB7XHJcbiAgICB0aGlzLl9oYW5kbGVDbGlja1N1Ym1pdCA9IGhhbmRsZXI7XHJcbiAgfVxyXG5cclxuICBzZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgIHN1cGVyLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcblxyXG4gICAgdGhpcy5fc3VibWl0QnV0dG9uRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcclxuICAgICAgdGhpcy5faGFuZGxlQ2xpY2tTdWJtaXQoKTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgZ2V0U3VibWl0QnV0dG9uKCkge1xyXG4gICAgcmV0dXJuIHRoaXMuX3N1Ym1pdEJ1dHRvbkVsZW1lbnQ7XHJcbiAgfVxyXG59XHJcbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFVzZXJJbmZvIHtcclxuICBjb25zdHJ1Y3Rvcih7IG5hbWVTZWxlY3RvciwgYWJvdXRTZWxlY3RvciwgYXZhdGFyU2VsZWN0b3IgfSkge1xyXG4gICAgdGhpcy5fbmFtZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IobmFtZVNlbGVjdG9yKTtcclxuICAgIHRoaXMuX2Fib3V0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihhYm91dFNlbGVjdG9yKTtcclxuICAgIHRoaXMuX2F2YXRhciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYXZhdGFyU2VsZWN0b3IpO1xyXG4gIH1cclxuXHJcbiAgZ2V0VXNlckluZm8oKSB7XHJcbiAgICBjb25zdCB1c2VySW5mb1Byb2ZpbGUgPSB7XHJcbiAgICAgIG5hbWU6IHRoaXMuX25hbWUudGV4dENvbnRlbnQsXHJcbiAgICAgIGFib3V0OiB0aGlzLl9hYm91dC50ZXh0Q29udGVudCxcclxuICAgICAgYXZhdGFyOiB0aGlzLl9hdmF0YXIuc3JjLFxyXG4gICAgfTtcclxuXHJcbiAgICByZXR1cm4gdXNlckluZm9Qcm9maWxlO1xyXG4gIH1cclxuXHJcbiAgc2V0VXNlckluZm8odXNlckRhdGEpIHtcclxuICAgIHRoaXMuX25hbWUudGV4dENvbnRlbnQgPSB1c2VyRGF0YS5uYW1lO1xyXG4gICAgdGhpcy5fYWJvdXQudGV4dENvbnRlbnQgPSB1c2VyRGF0YS5hYm91dDtcclxuICAgIHRoaXMuX2F2YXRhci5zcmMgPSB1c2VyRGF0YS5hdmF0YXI7XHJcbiAgfVxyXG59XHJcbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIEZvcm1WYWxpZGF0b3Ige1xyXG4gIGNvbnN0cnVjdG9yKGNvbmZpZywgZm9ybUVsZW1lbnQpIHtcclxuICAgIHRoaXMuX2lucHV0U2VsZWN0b3IgPSBjb25maWcuaW5wdXRTZWxlY3RvcjtcclxuICAgIHRoaXMuX2lucHV0RXJyb3JDbGFzcyA9IGNvbmZpZy5pbnB1dEVycm9yQ2xhc3M7XHJcbiAgICB0aGlzLl9lcnJvclNlbGVjdG9yID0gY29uZmlnLmVycm9yU2VsZWN0b3I7XHJcbiAgICB0aGlzLl9lcnJvckNsYXNzID0gY29uZmlnLmVycm9yQ2xhc3M7XHJcbiAgICB0aGlzLl9zdWJtaXRCdXR0b25TZWxlY3RvciA9IGNvbmZpZy5zdWJtaXRCdXR0b25TZWxlY3RvcjtcclxuICAgIHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MgPSBjb25maWcuaW5hY3RpdmVCdXR0b25DbGFzcztcclxuICAgIHRoaXMuX2Zvcm1FbGVtZW50ID0gZm9ybUVsZW1lbnQ7XHJcbiAgICB0aGlzLl9pbnB1dExpc3QgPSBBcnJheS5mcm9tKHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwodGhpcy5faW5wdXRTZWxlY3RvcikpO1xyXG4gICAgdGhpcy5fYnV0dG9uRWxlbWVudCA9IHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IodGhpcy5fc3VibWl0QnV0dG9uU2VsZWN0b3IpO1xyXG4gIH1cclxuXHJcbiAgZW5hYmxlVmFsaWRhdGlvbigpIHtcclxuICAgIHRoaXMuX3NldEV2ZW50TGlzdGVuZXJzKCk7XHJcbiAgfVxyXG5cclxuICBfc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICB0aGlzLl9pbnB1dExpc3QuZm9yRWFjaCgoaW5wdXRFbGVtZW50KSA9PiB7XHJcbiAgICAgIGlucHV0RWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCdpbnB1dCcsICgpID0+IHtcclxuICAgICAgICB0aGlzLl9pc1ZhbGlkKGlucHV0RWxlbWVudCk7XHJcbiAgICAgICAgdGhpcy5fdG9nZ2xlQnV0dG9uU3RhdGUoKTtcclxuICAgICAgfSk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIF9pc1ZhbGlkKGlucHV0RWxlbWVudCkge1xyXG4gICAgaWYgKCFpbnB1dEVsZW1lbnQudmFsaWRpdHkudmFsaWQpIHtcclxuICAgICAgdGhpcy5fc2hvd0lucHV0RXJyb3IoaW5wdXRFbGVtZW50LCBpbnB1dEVsZW1lbnQudmFsaWRhdGlvbk1lc3NhZ2UpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgdGhpcy5faGlkZUlucHV0RXJyb3IoaW5wdXRFbGVtZW50KTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIF9zaG93SW5wdXRFcnJvcihpbnB1dEVsZW1lbnQsIGVycm9yTWVzc2FnZSkge1xyXG4gICAgY29uc3QgZXJyb3JFbGVtZW50ID0gdGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvcihgLiR7aW5wdXRFbGVtZW50LmlkfS1lcnJvcmApO1xyXG5cclxuICAgIGlucHV0RWxlbWVudC5jbGFzc0xpc3QuYWRkKHRoaXMuX2lucHV0RXJyb3JDbGFzcyk7XHJcbiAgICBlcnJvckVsZW1lbnQudGV4dENvbnRlbnQgPSBlcnJvck1lc3NhZ2U7XHJcbiAgICBlcnJvckVsZW1lbnQuY2xhc3NMaXN0LmFkZCh0aGlzLl9lcnJvckNsYXNzKTtcclxuICB9XHJcblxyXG4gIF9oaWRlSW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpIHtcclxuICAgIGNvbnN0IGVycm9yRWxlbWVudCA9IHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoYC4ke2lucHV0RWxlbWVudC5pZH0tZXJyb3JgKTtcclxuXHJcbiAgICBpbnB1dEVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9pbnB1dEVycm9yQ2xhc3MpO1xyXG4gICAgZXJyb3JFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUodGhpcy5fZXJyb3JDbGFzcyk7XHJcbiAgICBlcnJvckVsZW1lbnQudGV4dENvbnRlbnQgPSAnJztcclxuICB9XHJcblxyXG4gIF90b2dnbGVCdXR0b25TdGF0ZSgpIHtcclxuICAgIGlmICh0aGlzLl9oYXNJbnZhbGlkSW5wdXQoKSkge1xyXG4gICAgICB0aGlzLl9kaXNhYmxlQnV0dG9uKCk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICB0aGlzLl9lbmFibGVCdXR0b24oKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIF9oYXNJbnZhbGlkSW5wdXQoKSB7XHJcbiAgICByZXR1cm4gdGhpcy5faW5wdXRMaXN0LnNvbWUoKGlucHV0RWxlbWVudCkgPT4ge1xyXG4gICAgICByZXR1cm4gIWlucHV0RWxlbWVudC52YWxpZGl0eS52YWxpZDtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgX2Rpc2FibGVCdXR0b24oKSB7XHJcbiAgICB0aGlzLl9idXR0b25FbGVtZW50LmNsYXNzTGlzdC5hZGQodGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcyk7XHJcbiAgICB0aGlzLl9idXR0b25FbGVtZW50LnNldEF0dHJpYnV0ZSgnZGlzYWJsZWQnLCB0cnVlKTtcclxuICB9XHJcblxyXG4gIF9lbmFibGVCdXR0b24oKSB7XHJcbiAgICB0aGlzLl9idXR0b25FbGVtZW50LnJlbW92ZUF0dHJpYnV0ZSgnZGlzYWJsZWQnKTtcclxuICAgIHRoaXMuX2J1dHRvbkVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcclxuICB9XHJcblxyXG4gIHJlc2V0VmFsaWRhdGlvbigpIHtcclxuICAgIHRoaXMuX3RvZ2dsZUJ1dHRvblN0YXRlKCk7XHJcbiAgICB0aGlzLl9pbnB1dExpc3QuZm9yRWFjaCgoaW5wdXRFbGVtZW50KSA9PiB7XHJcbiAgICAgIHRoaXMuX2hpZGVJbnB1dEVycm9yKGlucHV0RWxlbWVudCk7XHJcbiAgICB9KTtcclxuICB9XHJcbn1cclxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgQXBpIHtcclxuICBjb25zdHJ1Y3RvcihvcHRpb25zKSB7XHJcbiAgICB0aGlzLl91cmwgPSBvcHRpb25zLmJhc2VVcmw7XHJcbiAgICB0aGlzLl9oZWFkZXJzID0gb3B0aW9ucy5oZWFkZXJzO1xyXG4gIH1cclxuXHJcbiAgX2hhbmRsZVJlc3BvbnNlKHJlcywgZXJyb3JUZXh0KSB7XHJcbiAgICBpZiAocmVzLm9rKSB7XHJcbiAgICAgIHJldHVybiByZXMuanNvbigpO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGVycm9yVGV4dCk7XHJcbiAgfVxyXG5cclxuICBnZXRVc2VySW5mbygpIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl91cmx9L3VzZXJzL21lYCwge1xyXG4gICAgICBtZXRob2Q6ICdHRVQnLFxyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgfSkudGhlbigocmVzKSA9PiB7XHJcbiAgICAgIHJldHVybiB0aGlzLl9oYW5kbGVSZXNwb25zZShyZXMsICfQlNCw0L3QvdGL0LUg0L/QvtC70YzQt9C+0LLQsNGC0LXQu9GPINC90LUg0L/QvtC70YPRh9C10L3RiycpO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBnZXRJbml0aWFsQ2FyZHMoKSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fdXJsfS9jYXJkc2AsIHtcclxuICAgICAgbWV0aG9kOiAnR0VUJyxcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgIH0pLnRoZW4oKHJlcykgPT4ge1xyXG4gICAgICByZXR1cm4gdGhpcy5faGFuZGxlUmVzcG9uc2UocmVzLCAn0KHQv9C40YHQvtC6INC60LDRgNGC0L7Rh9C10Log0L3QtSDQv9C+0LvRg9GH0LXQvScpO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBnZXRJbml0aWFsRGF0YSgpIHtcclxuICAgIHJldHVybiBQcm9taXNlLmFsbChbdGhpcy5nZXRVc2VySW5mbygpLCB0aGlzLmdldEluaXRpYWxDYXJkcygpXSk7XHJcbiAgfVxyXG5cclxuICBlZGl0VXNlckluZm8oZGF0YSkge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX3VybH0vdXNlcnMvbWVgLCB7XHJcbiAgICAgIG1ldGhvZDogJ1BBVENIJyxcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoZGF0YSksXHJcbiAgICB9KS50aGVuKChyZXMpID0+IHtcclxuICAgICAgcmV0dXJuIHRoaXMuX2hhbmRsZVJlc3BvbnNlKHJlcywgJ9CU0LDQvdC90YvQtSDQv9C+0LvRjNC30L7QstCw0YLQtdC70Y8g0L3QtSDQuNC30LzQtdC90LXQvdGLJyk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIGFkZE5ld0NhcmQoZGF0YSkge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX3VybH0vY2FyZHNgLCB7XHJcbiAgICAgIG1ldGhvZDogJ1BPU1QnLFxyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeShkYXRhKSxcclxuICAgIH0pLnRoZW4oKHJlcykgPT4ge1xyXG4gICAgICByZXR1cm4gdGhpcy5faGFuZGxlUmVzcG9uc2UocmVzLCAn0JrQsNGA0YLQvtGH0LrQsCDQvdC1INC00L7QsdCw0LLQu9C10L3QsCcpO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBkZWxldGVDYXJkKGlkKSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fdXJsfS9jYXJkcy8ke2lkfWAsIHtcclxuICAgICAgbWV0aG9kOiAnREVMRVRFJyxcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgIH0pLnRoZW4oKHJlcykgPT4ge1xyXG4gICAgICByZXR1cm4gdGhpcy5faGFuZGxlUmVzcG9uc2UocmVzLCAn0JrQsNGA0YLQvtGH0LrQsCDQvdC1INGD0LTQsNC70LXQvdCwJyk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIHB1dExpa2UoaWQpIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl91cmx9L2NhcmRzLyR7aWR9L2xpa2VzYCwge1xyXG4gICAgICBtZXRob2Q6ICdQVVQnLFxyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgfSkudGhlbigocmVzKSA9PiB7XHJcbiAgICAgIHJldHVybiB0aGlzLl9oYW5kbGVSZXNwb25zZShyZXMsICfQm9Cw0LnQuiDQvdC1INC00L7QsdCw0LLQu9C10L0nKTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgZGVsZXRlTGlrZShpZCkge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX3VybH0vY2FyZHMvJHtpZH0vbGlrZXNgLCB7XHJcbiAgICAgIG1ldGhvZDogJ0RFTEVURScsXHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICB9KS50aGVuKChyZXMpID0+IHtcclxuICAgICAgcmV0dXJuIHRoaXMuX2hhbmRsZVJlc3BvbnNlKHJlcywgJ9Cb0LDQudC6INC90LUg0YPQsdGA0LDQvScpO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICB1cGRhdGVBdmF0YXIoZGF0YSkge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX3VybH0vdXNlcnMvbWUvYXZhdGFyYCwge1xyXG4gICAgICBtZXRob2Q6ICdQQVRDSCcsXHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KGRhdGEpLFxyXG4gICAgfSkudGhlbigocmVzKSA9PiB7XHJcbiAgICAgIHJldHVybiB0aGlzLl9oYW5kbGVSZXNwb25zZShyZXMsICfQkNCy0LDRgtCw0YAg0L/QvtC70YzQt9C+0LLQsNGC0LXQu9GPINC90LUg0LjQt9C80LXQvdC10L0nKTtcclxuICAgIH0pO1xyXG4gIH1cclxufVxyXG4iLCJpbXBvcnQgJy4vaW5kZXguY3NzJztcclxuXHJcbmltcG9ydCB7XHJcbiAgYnV0dG9uRm9yRWRpdGluZ1Byb2ZpbGUsXHJcbiAgYnV0dG9uRm9yQWRkaW5nQ2FyZCxcclxuICBidXR0b25Gb3JVcGRhdGluZ0F2YXRhcixcclxuICBjYXJkc1NlbGVjdG9yLFxyXG4gIGNvbmZpZyxcclxuICBmb3JtVmFsaWRhdG9ycyxcclxuICBmb3JtTGlzdCxcclxuICBzYXZlVGV4dCxcclxuICBkZWxldGVUZXh0LFxyXG59IGZyb20gJy4uLy4uL3NjcmlwdHMvdXRpbHMvY29uc3RhbnRzLmpzJztcclxuXHJcbmltcG9ydCBTZWN0aW9uIGZyb20gJy4uLy4uL3NjcmlwdHMvY29tcG9uZW50cy9TZWN0aW9uLmpzJztcclxuaW1wb3J0IENhcmQgZnJvbSAnLi4vLi4vc2NyaXB0cy9jb21wb25lbnRzL0NhcmQuanMnO1xyXG5pbXBvcnQgUG9wdXBXaXRoSW1hZ2UgZnJvbSAnLi4vLi4vc2NyaXB0cy9jb21wb25lbnRzL1BvcHVwV2l0aEltYWdlLmpzJztcclxuaW1wb3J0IFBvcHVwV2l0aEZvcm0gZnJvbSAnLi4vLi4vc2NyaXB0cy9jb21wb25lbnRzL1BvcHVwV2l0aEZvcm0uanMnO1xyXG5pbXBvcnQgUG9wdXBXaXRoQ29uZmlybWF0aW9uIGZyb20gJy4uLy4uL3NjcmlwdHMvY29tcG9uZW50cy9Qb3B1cFdpdGhDb25maXJtYXRpb24uanMnO1xyXG5pbXBvcnQgVXNlckluZm8gZnJvbSAnLi4vLi4vc2NyaXB0cy9jb21wb25lbnRzL1VzZXJJbmZvLmpzJztcclxuaW1wb3J0IEZvcm1WYWxpZGF0b3IgZnJvbSAnLi4vLi4vc2NyaXB0cy9jb21wb25lbnRzL0Zvcm1WYWxpZGF0b3IuanMnO1xyXG5pbXBvcnQgQXBpIGZyb20gJy4uLy4uL3NjcmlwdHMvY29tcG9uZW50cy9BcGkuanMnO1xyXG5cclxuLy8gU3luY1xyXG5cclxuLy8gQ3JlYXRlIHBvcHVwIHdpdGggdGhlIGltYWdlXHJcblxyXG5jb25zdCBwb3B1cEVubGFyZ2luZyA9IG5ldyBQb3B1cFdpdGhJbWFnZSgnLnBvcHVwX3R5cGVfZW5sYXJnZScpO1xyXG5wb3B1cEVubGFyZ2luZy5zZXRFdmVudExpc3RlbmVycygpO1xyXG5cclxuLy8gQ3JlYXRlIHBvcHVwIHdpdGggdGhlIHN1Ym1pdFxyXG5cclxuY29uc3QgcG9wdXBTdWJtaXRpbmcgPSBuZXcgUG9wdXBXaXRoQ29uZmlybWF0aW9uKCcucG9wdXBfdHlwZV9zdWJtaXQnKTtcclxucG9wdXBTdWJtaXRpbmcuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuXHJcbi8vIEZ1bmN0aW9uIHRvIGNoYW5nZSB0aGUgc3VibWl0IGJ1dHRvbiB0ZXh0IHdoZW4gdG8gcmVxdWVzdCB0byB0aGUgc2VydmVyXHJcblxyXG5mdW5jdGlvbiBnZXRTdWJtaXRJbml0aWFsVGV4dChwb3B1cCkge1xyXG4gIGNvbnN0IGluaXRpYWxUZXh0ID0gcG9wdXAuZ2V0U3VibWl0QnV0dG9uKCkudGV4dENvbnRlbnQ7XHJcbiAgcmV0dXJuIGluaXRpYWxUZXh0O1xyXG59XHJcblxyXG5mdW5jdGlvbiBjaGFuZ2VTdWJtaXRUZXh0KHN0YXJ0RG93bmxvYWQsIHBvcHVwLCBpbml0aWFsVGV4dCwgdXBsb2FkVGV4dCkge1xyXG4gIGNvbnN0IHN1Ym1pdEJ1dHRvbiA9IHBvcHVwLmdldFN1Ym1pdEJ1dHRvbigpO1xyXG5cclxuICBpZiAoc3RhcnREb3dubG9hZCkge1xyXG4gICAgc3VibWl0QnV0dG9uLnRleHRDb250ZW50ID0gdXBsb2FkVGV4dDtcclxuICB9IGVsc2Uge1xyXG4gICAgc3VibWl0QnV0dG9uLnRleHRDb250ZW50ID0gaW5pdGlhbFRleHQ7XHJcbiAgfVxyXG59XHJcblxyXG4vLyBDcmVhdGUgdGhlIHVzZXIgaW5mbyBjb250cm9sIG9iamVjdFxyXG5cclxuY29uc3QgdXNlckluZm8gPSBuZXcgVXNlckluZm8oe1xyXG4gIG5hbWVTZWxlY3RvcjogJy5wcm9maWxlX19uYW1lJyxcclxuICBhYm91dFNlbGVjdG9yOiAnLnByb2ZpbGVfX2Fib3V0JyxcclxuICBhdmF0YXJTZWxlY3RvcjogJy5wcm9maWxlX19waG90bycsXHJcbn0pO1xyXG5cclxuLy8gQ29uZmlndXJlIEFwaVxyXG5cclxuY29uc3QgYXBpID0gbmV3IEFwaSh7XHJcbiAgYmFzZVVybDogJ2h0dHBzOi8vbWVzdG8ubm9tb3JlcGFydGllcy5jby92MS9jb2hvcnQtNDEnLFxyXG4gIGhlYWRlcnM6IHtcclxuICAgIGF1dGhvcml6YXRpb246ICdiNmJkZTliZS04Njc0LTRlY2EtODE3OS0zMDJlMGE0ZTJiNmYnLFxyXG4gICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJyxcclxuICB9LFxyXG59KTtcclxuXHJcbi8vIEFzeW5jaFxyXG5cclxuLy8gR2V0IGluaXRpYWwgZGF0YSBmcm9tIHRoZSBzZXJ2ZXJcclxuXHJcbmFwaVxyXG4gIC5nZXRJbml0aWFsRGF0YSgpXHJcbiAgLnRoZW4oKGluaXRpYWxEYXRhKSA9PiB7XHJcbiAgICBjb25zdCBbdXNlckRhdGEsIGluaXRpYWxDYXJkc0RhdGFdID0gaW5pdGlhbERhdGE7XHJcblxyXG4gICAgLy8gU2V0IHVzZXIgaW5mb1xyXG5cclxuICAgIHVzZXJJbmZvLnNldFVzZXJJbmZvKHVzZXJEYXRhKTtcclxuXHJcbiAgICAvLyBGdW5jdGlvbiBmb3IgY2hlY2tpbmcgdGhlIGNhcmQgZm9yIGxpa2VzXHJcblxyXG4gICAgZnVuY3Rpb24gY2hlY2tMaWtlQ2FyZChpdGVtKSB7XHJcbiAgICAgIHJldHVybiBpdGVtLmxpa2VzLnNvbWUoKGxpa2UpID0+IGxpa2UuX2lkID09PSB1c2VyRGF0YS5faWQpO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIEZ1bmN0aW9uIGZvciBjcmVhdGluZyBhIGNhcmRcclxuXHJcbiAgICBmdW5jdGlvbiBjcmVhdGVDYXJkKGl0ZW0pIHtcclxuICAgICAgY29uc3QgY2FyZEVsZW1lbnQgPSBuZXcgQ2FyZChcclxuICAgICAgICB7XHJcbiAgICAgICAgICBkYXRhOiBpdGVtLFxyXG4gICAgICAgICAgaGFuZGxlQ2FyZENsaWNrOiAoKSA9PiB7XHJcbiAgICAgICAgICAgIHBvcHVwRW5sYXJnaW5nLm9wZW4oaXRlbSk7XHJcbiAgICAgICAgICB9LFxyXG4gICAgICAgICAgaGFuZGxlTGlrZUNsaWNrOiAoKSA9PiB7XHJcbiAgICAgICAgICAgIC8vIEZ1bmN0aW9uIGZvciB1cGRhdGluZyBjb3VudGVyIGFmdGVyIGNoYW5naW5nIHRoZSBsaWtlXHJcblxyXG4gICAgICAgICAgICBmdW5jdGlvbiB1cGRhdGXQoW91bnRlcihjYXJkRGF0YSkge1xyXG4gICAgICAgICAgICAgIGNhcmRFbGVtZW50LnVwZGF0ZdChb3VudGVyKGNhcmREYXRhLmxpa2VzLmxlbmd0aCk7XHJcbiAgICAgICAgICAgICAgaXRlbS5saWtlcyA9IGNhcmREYXRhLmxpa2VzO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAvLyBEZWxldGUgYSBsaWtlLCBpZiB0aGVyZSBpcyBvbmUsIG90aGVyd2lzZSBwdXQgdGhlIGxpa2VcclxuXHJcbiAgICAgICAgICAgIGlmIChjaGVja0xpa2VDYXJkKGl0ZW0pKSB7XHJcbiAgICAgICAgICAgICAgYXBpXHJcbiAgICAgICAgICAgICAgICAuZGVsZXRlTGlrZShpdGVtLl9pZClcclxuICAgICAgICAgICAgICAgIC50aGVuKChjYXJkRGF0YSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICBjYXJkRWxlbWVudC5kZWxldGVMaWtlKCk7XHJcbiAgICAgICAgICAgICAgICAgIHVwZGF0ZdChb3VudGVyKGNhcmREYXRhKTtcclxuICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAuY2F0Y2goKGVycm9yKSA9PiBjb25zb2xlLmxvZyhg0J7RiNC40LHQutCwOiAke2Vycm9yfWApKTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICBhcGlcclxuICAgICAgICAgICAgICAgIC5wdXRMaWtlKGl0ZW0uX2lkKVxyXG4gICAgICAgICAgICAgICAgLnRoZW4oKGNhcmREYXRhKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgIGNhcmRFbGVtZW50LnB1dExpa2UoKTtcclxuICAgICAgICAgICAgICAgICAgdXBkYXRl0KFvdW50ZXIoY2FyZERhdGEpO1xyXG4gICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgIC5jYXRjaCgoZXJyb3IpID0+IGNvbnNvbGUubG9nKGDQntGI0LjQsdC60LA6ICR7ZXJyb3J9YCkpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICB9LFxyXG4gICAgICAgICAgaGFuZGxlRGVsZXRlQnV0dG9uQ2xpY2s6ICgpID0+IHtcclxuICAgICAgICAgICAgcG9wdXBTdWJtaXRpbmcuc2V0SGFuZGxlcigoKSA9PiB7XHJcbiAgICAgICAgICAgICAgLy8gTWFuYWdlIHN1Ym1pdCBidXR0b24gdGV4dFxyXG5cclxuICAgICAgICAgICAgICBjb25zdCBpbml0aWFsVGV4dCA9IGdldFN1Ym1pdEluaXRpYWxUZXh0KHBvcHVwU3VibWl0aW5nKTtcclxuICAgICAgICAgICAgICBjaGFuZ2VTdWJtaXRUZXh0KHRydWUsIHBvcHVwU3VibWl0aW5nLCBpbml0aWFsVGV4dCwgZGVsZXRlVGV4dCk7XHJcblxyXG4gICAgICAgICAgICAgIGFwaVxyXG4gICAgICAgICAgICAgICAgLmRlbGV0ZUNhcmQoaXRlbS5faWQpXHJcbiAgICAgICAgICAgICAgICAudGhlbigoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgIGNhcmRFbGVtZW50LmRlbGV0ZUNhcmQoKTtcclxuICAgICAgICAgICAgICAgICAgcG9wdXBTdWJtaXRpbmcuY2xvc2UoKTtcclxuICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAuY2F0Y2goKGVycm9yKSA9PiBjb25zb2xlLmxvZyhg0J7RiNC40LHQutCwOiAke2Vycm9yfWApKVxyXG4gICAgICAgICAgICAgICAgLmZpbmFsbHkoKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICBjaGFuZ2VTdWJtaXRUZXh0KGZhbHNlLCBwb3B1cFN1Ym1pdGluZywgaW5pdGlhbFRleHQsIGRlbGV0ZVRleHQpO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgcG9wdXBTdWJtaXRpbmcub3BlbigpO1xyXG4gICAgICAgICAgfSxcclxuICAgICAgICB9LFxyXG4gICAgICAgICcucGxhY2UtdGVtcGxhdGUnXHJcbiAgICAgICk7XHJcblxyXG4gICAgICByZXR1cm4gY2FyZEVsZW1lbnQ7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gUmVuZGVyIGluaXRpYWwgY2FyZHNcclxuXHJcbiAgICBjb25zdCBjYXJkTGlzdCA9IG5ldyBTZWN0aW9uKFxyXG4gICAgICB7XHJcbiAgICAgICAgaXRlbXM6IGluaXRpYWxDYXJkc0RhdGEucmV2ZXJzZSgpLFxyXG4gICAgICAgIHJlbmRlcjogKGl0ZW0pID0+IHtcclxuICAgICAgICAgIC8vIGNoZWNrIGEgY2FyZCBvd25lciBhbmQgdXNlcidzIGxpa2VcclxuXHJcbiAgICAgICAgICBjb25zdCBpc05vdFVzZXJDYXJkID0gaXRlbS5vd25lci5faWQgPT09IHVzZXJEYXRhLl9pZCA/IGZhbHNlIDogdHJ1ZTtcclxuICAgICAgICAgIGNvbnN0IGlzTGlrZWRCeVVzZXIgPSBjaGVja0xpa2VDYXJkKGl0ZW0pO1xyXG5cclxuICAgICAgICAgIGNvbnN0IGNhcmRFbGVtZW50ID0gY3JlYXRlQ2FyZChpdGVtKS5nZW5lcmF0ZUNhcmQoeyBpc05vdFVzZXJDYXJkLCBpc0xpa2VkQnlVc2VyIH0pO1xyXG4gICAgICAgICAgY2FyZExpc3QuYWRkSXRlbShjYXJkRWxlbWVudCk7XHJcbiAgICAgICAgfSxcclxuICAgICAgfSxcclxuICAgICAgY2FyZHNTZWxlY3RvclxyXG4gICAgKTtcclxuICAgIGNhcmRMaXN0LnJlbmRlckl0ZW1zKCk7XHJcblxyXG4gICAgcmV0dXJuIHsgdXNlckRhdGEsIGluaXRpYWxDYXJkc0RhdGEsIGNhcmRMaXN0IH07XHJcbiAgfSlcclxuXHJcbiAgLnRoZW4oKGRhdGFPYmplY3QpID0+IHtcclxuICAgIC8vIEZ1bmN0aW9uIHRvIHN0YXJ0IHZhbGlkYXRpb25cclxuXHJcbiAgICBmdW5jdGlvbiBlbmFibGVWYWxpZGF0aW9uKGNvbmZpZykge1xyXG4gICAgICBmb3JtTGlzdC5mb3JFYWNoKChmb3JtRWxlbWVudCkgPT4ge1xyXG4gICAgICAgIGNvbnN0IHZhbGlkYXRvciA9IG5ldyBGb3JtVmFsaWRhdG9yKGNvbmZpZywgZm9ybUVsZW1lbnQpO1xyXG4gICAgICAgIGNvbnN0IGZvcm1OYW1lID0gZm9ybUVsZW1lbnQuZ2V0QXR0cmlidXRlKCduYW1lJyk7XHJcblxyXG4gICAgICAgIGZvcm1WYWxpZGF0b3JzW2Zvcm1OYW1lXSA9IHZhbGlkYXRvcjtcclxuXHJcbiAgICAgICAgdmFsaWRhdG9yLmVuYWJsZVZhbGlkYXRpb24oKTtcclxuICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gU3RhcnQgZm9ybSB2YWxpZGF0aW9uXHJcblxyXG4gICAgZW5hYmxlVmFsaWRhdGlvbihjb25maWcpO1xyXG5cclxuICAgIHJldHVybiBkYXRhT2JqZWN0O1xyXG4gIH0pXHJcblxyXG4gIC50aGVuKChkYXRhT2JqZWN0KSA9PiB7XHJcbiAgICAvLyBDcmVhdGUgYSBwb3B1cCBmb3IgZWRpdGluZ1xyXG5cclxuICAgIGNvbnN0IHBvcHVwRWRpdGluZyA9IG5ldyBQb3B1cFdpdGhGb3JtKCcucG9wdXBfdHlwZV9lZGl0JywgKGlucHV0VmFsdWVzKSA9PiB7XHJcbiAgICAgIC8vIE1hbmFnZSBzdWJtaXQgYnV0dG9uIHRleHRcclxuXHJcbiAgICAgIGNvbnN0IGluaXRpYWxUZXh0ID0gZ2V0U3VibWl0SW5pdGlhbFRleHQocG9wdXBFZGl0aW5nKTtcclxuICAgICAgY2hhbmdlU3VibWl0VGV4dCh0cnVlLCBwb3B1cEVkaXRpbmcsIGluaXRpYWxUZXh0LCBzYXZlVGV4dCk7XHJcblxyXG4gICAgICAvLyBFZGl0IHVzZXIgaW5mb1xyXG5cclxuICAgICAgYXBpXHJcbiAgICAgICAgLmVkaXRVc2VySW5mbyhpbnB1dFZhbHVlcylcclxuICAgICAgICAudGhlbigodXNlckRhdGEpID0+IHtcclxuICAgICAgICAgIHVzZXJJbmZvLnNldFVzZXJJbmZvKHVzZXJEYXRhKTtcclxuICAgICAgICAgIHBvcHVwRWRpdGluZy5jbG9zZSgpO1xyXG4gICAgICAgIH0pXHJcbiAgICAgICAgLmNhdGNoKChlcnJvcikgPT4gY29uc29sZS5sb2coYNCe0YjQuNCx0LrQsDogJHtlcnJvcn1gKSlcclxuICAgICAgICAuZmluYWxseSgoKSA9PiB7XHJcbiAgICAgICAgICBjaGFuZ2VTdWJtaXRUZXh0KGZhbHNlLCBwb3B1cEVkaXRpbmcsIGluaXRpYWxUZXh0LCBzYXZlVGV4dCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBwb3B1cEVkaXRpbmcuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuXHJcbiAgICAvLyBBZGQgbGlzdGVuZXJzIHRvIG9wZW4gdGhlIHBvcHVwIGZvciBlZGl0aW5nXHJcblxyXG4gICAgZnVuY3Rpb24gaGFuZGxlRWRpdEJ1dHRvbigpIHtcclxuICAgICAgcG9wdXBFZGl0aW5nLnNldElucHV0VmFsdWVzKHVzZXJJbmZvLmdldFVzZXJJbmZvKCkpO1xyXG4gICAgICBmb3JtVmFsaWRhdG9yc1snZWRpdCddLnJlc2V0VmFsaWRhdGlvbigpO1xyXG4gICAgICBwb3B1cEVkaXRpbmcub3BlbigpO1xyXG4gICAgfVxyXG5cclxuICAgIGJ1dHRvbkZvckVkaXRpbmdQcm9maWxlLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgaGFuZGxlRWRpdEJ1dHRvbik7XHJcblxyXG4gICAgcmV0dXJuIGRhdGFPYmplY3Q7XHJcbiAgfSlcclxuXHJcbiAgLnRoZW4oKGRhdGFPYmplY3QpID0+IHtcclxuICAgIC8vIENyZWF0ZSBhIHBvcHVwIGZvciBhZGRpbmdcclxuXHJcbiAgICBjb25zdCBwb3B1cEFkZGluZyA9IG5ldyBQb3B1cFdpdGhGb3JtKCcucG9wdXBfdHlwZV9hZGQnLCAoaW5wdXRWYWx1ZXMpID0+IHtcclxuICAgICAgLy8gTWFuYWdlIHN1Ym1pdCBidXR0b24gdGV4dFxyXG5cclxuICAgICAgY29uc3QgaW5pdGlhbFRleHQgPSBnZXRTdWJtaXRJbml0aWFsVGV4dChwb3B1cEFkZGluZyk7XHJcbiAgICAgIGNoYW5nZVN1Ym1pdFRleHQodHJ1ZSwgcG9wdXBBZGRpbmcsIGluaXRpYWxUZXh0LCBzYXZlVGV4dCk7XHJcblxyXG4gICAgICAvLyBHZXQgZGF0YSBmcm9tIHBvcHVwIGFkZGluZ1xyXG5cclxuICAgICAgY29uc3QgZGF0YSA9IHtcclxuICAgICAgICBuYW1lOiBpbnB1dFZhbHVlcy5wbGFjZSxcclxuICAgICAgICBsaW5rOiBpbnB1dFZhbHVlcy5saW5rLFxyXG4gICAgICB9O1xyXG5cclxuICAgICAgLy8gQWRkIGEgbmV3IGNhcmRcclxuXHJcbiAgICAgIGFwaVxyXG4gICAgICAgIC5hZGROZXdDYXJkKGRhdGEpXHJcbiAgICAgICAgLnRoZW4oKGRhdGEpID0+IHtcclxuICAgICAgICAgIGRhdGFPYmplY3QuY2FyZExpc3QucmVuZGVyT25lSXRlbShkYXRhKTtcclxuICAgICAgICAgIHBvcHVwQWRkaW5nLmNsb3NlKCk7XHJcbiAgICAgICAgfSlcclxuICAgICAgICAuY2F0Y2goKGVycm9yKSA9PiBjb25zb2xlLmxvZyhg0J7RiNC40LHQutCwOiAke2Vycm9yfWApKVxyXG4gICAgICAgIC5maW5hbGx5KCgpID0+IHtcclxuICAgICAgICAgIGNoYW5nZVN1Ym1pdFRleHQoZmFsc2UsIHBvcHVwQWRkaW5nLCBpbml0aWFsVGV4dCwgc2F2ZVRleHQpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfSk7XHJcblxyXG4gICAgcG9wdXBBZGRpbmcuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuXHJcbiAgICAvLyBBZGQgbGlzdGVuZXJzIHRvIG9wZW4gdGhlIHBvcHVwIGZvciBhZGRpbmdcclxuXHJcbiAgICBmdW5jdGlvbiBoYW5kbGVCdXR0b25Gb3JBZGRpbmdDYXJkKCkge1xyXG4gICAgICBmb3JtVmFsaWRhdG9yc1snYWRkJ10ucmVzZXRWYWxpZGF0aW9uKCk7XHJcbiAgICAgIHBvcHVwQWRkaW5nLm9wZW4oKTtcclxuICAgIH1cclxuXHJcbiAgICBidXR0b25Gb3JBZGRpbmdDYXJkLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgaGFuZGxlQnV0dG9uRm9yQWRkaW5nQ2FyZCk7XHJcblxyXG4gICAgcmV0dXJuIGRhdGFPYmplY3Q7XHJcbiAgfSlcclxuXHJcbiAgLnRoZW4oKGRhdGFPYmplY3QpID0+IHtcclxuICAgIC8vIENyZWF0ZSBhIHBvcHVwIHRvIHVwZGF0ZSBhdmF0YXJcclxuXHJcbiAgICBjb25zdCBwb3B1cFVwZGF0aW5nQXZhdGFyID0gbmV3IFBvcHVwV2l0aEZvcm0oJy5wb3B1cF90eXBlX3VwZGF0ZS1hdmF0YXInLCAoaW5wdXRWYWx1ZXMpID0+IHtcclxuICAgICAgLy8gTWFuYWdlIHN1Ym1pdCBidXR0b24gdGV4dFxyXG5cclxuICAgICAgY29uc3QgaW5pdGlhbFRleHQgPSBnZXRTdWJtaXRJbml0aWFsVGV4dChwb3B1cFVwZGF0aW5nQXZhdGFyKTtcclxuICAgICAgY2hhbmdlU3VibWl0VGV4dCh0cnVlLCBwb3B1cFVwZGF0aW5nQXZhdGFyLCBpbml0aWFsVGV4dCwgc2F2ZVRleHQpO1xyXG5cclxuICAgICAgY29uc3QgZGF0YSA9IHtcclxuICAgICAgICBhdmF0YXI6IGlucHV0VmFsdWVzWydhdmF0YXItbGluayddLFxyXG4gICAgICB9O1xyXG5cclxuICAgICAgLy8gVXBkYXRlIGF2YXRhclxyXG5cclxuICAgICAgYXBpXHJcbiAgICAgICAgLnVwZGF0ZUF2YXRhcihkYXRhKVxyXG4gICAgICAgIC50aGVuKCh1c2VyRGF0YSkgPT4ge1xyXG4gICAgICAgICAgdXNlckluZm8uc2V0VXNlckluZm8odXNlckRhdGEpO1xyXG4gICAgICAgICAgcG9wdXBVcGRhdGluZ0F2YXRhci5jbG9zZSgpO1xyXG4gICAgICAgIH0pXHJcbiAgICAgICAgLmNhdGNoKChlcnJvcikgPT4gY29uc29sZS5sb2coYNCe0YjQuNCx0LrQsDogJHtlcnJvcn1gKSlcclxuICAgICAgICAuZmluYWxseSgoKSA9PiB7XHJcbiAgICAgICAgICBjaGFuZ2VTdWJtaXRUZXh0KGZhbHNlLCBwb3B1cFVwZGF0aW5nQXZhdGFyLCBpbml0aWFsVGV4dCwgc2F2ZVRleHQpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfSk7XHJcblxyXG4gICAgcG9wdXBVcGRhdGluZ0F2YXRhci5zZXRFdmVudExpc3RlbmVycygpO1xyXG5cclxuICAgIC8vIEFkZCBsaXN0ZW5lcnMgdG8gb3BlbiB0aGUgcG9wdXAgZm9yIGFkZGluZ1xyXG5cclxuICAgIGZ1bmN0aW9uIGhhbmRsZUJ1dHRvbkZvclVwZGF0aW5nQXZhdGFyKCkge1xyXG4gICAgICBmb3JtVmFsaWRhdG9yc1sndXBkYXRlLWF2YXRhciddLnJlc2V0VmFsaWRhdGlvbigpO1xyXG4gICAgICBwb3B1cFVwZGF0aW5nQXZhdGFyLm9wZW4oKTtcclxuICAgIH1cclxuXHJcbiAgICBidXR0b25Gb3JVcGRhdGluZ0F2YXRhci5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGhhbmRsZUJ1dHRvbkZvclVwZGF0aW5nQXZhdGFyKTtcclxuXHJcbiAgICByZXR1cm4gZGF0YU9iamVjdDtcclxuICB9KVxyXG5cclxuICAuY2F0Y2goKGVycm9yKSA9PiBjb25zb2xlLmxvZyhg0J7RiNC40LHQutCwOiAke2Vycm9yfWApKTtcclxuIl0sIm5hbWVzIjpbInByb2ZpbGUiLCJkb2N1bWVudCIsInF1ZXJ5U2VsZWN0b3IiLCJidXR0b25Gb3JFZGl0aW5nUHJvZmlsZSIsImJ1dHRvbkZvckFkZGluZ0NhcmQiLCJidXR0b25Gb3JVcGRhdGluZ0F2YXRhciIsImNvbmZpZyIsImlucHV0U2VsZWN0b3IiLCJpbnB1dEVycm9yQ2xhc3MiLCJlcnJvclNlbGVjdG9yIiwiZXJyb3JDbGFzcyIsInN1Ym1pdEJ1dHRvblNlbGVjdG9yIiwiaW5hY3RpdmVCdXR0b25DbGFzcyIsImZvcm1WYWxpZGF0b3JzIiwiZm9ybUxpc3QiLCJBcnJheSIsImZyb20iLCJmb3JtcyIsInNhdmVUZXh0IiwiZGVsZXRlVGV4dCIsIlNlY3Rpb24iLCJjb250YWluZXJTZWxlY3RvciIsIml0ZW1zIiwicmVuZGVyIiwidGhpcyIsIl9pdGVtcyIsIl9yZW5kZXJlciIsIl9jb250YWluZXIiLCJmb3JFYWNoIiwiaXRlbSIsImVsZW1lbnQiLCJwcmVwZW5kIiwiQ2FyZCIsImNhcmRTZWxlY3RvciIsImRhdGEiLCJoYW5kbGVDYXJkQ2xpY2siLCJoYW5kbGVMaWtlQ2xpY2siLCJoYW5kbGVEZWxldGVCdXR0b25DbGljayIsIl9kYXRhIiwiX3RpdGxlIiwibmFtZSIsIl9saW5rIiwibGluayIsIl9saWtlcyIsImxpa2VzIiwibGVuZ3RoIiwiX2lkIiwiX293bmVySWQiLCJvd25lciIsIl9hbHQiLCJfaGFuZGxlQ2FyZENsaWNrIiwiX2hhbmRsZUxpa2VDbGljayIsIl9oYW5kbGVEZWxldGVCdXR0b25DbGljayIsIl9jYXJkU2VsZWN0b3IiLCJjb250ZW50IiwiY2xvbmVOb2RlIiwiaXNOb3RVc2VyQ2FyZCIsIl9kZWxldGVCdXR0b24iLCJyZW1vdmUiLCJpc0xpa2VkQnlVc2VyIiwicHV0TGlrZSIsImNoZdGBa3MiLCJfZWxlbWVudCIsIl9nZXRUZW1wbGF0ZSIsIl9saWtlQnV0dG9uIiwiX2VubGFyZ2VCdXR0b24iLCJfY2FyZExpa2VzIiwiY2FyZFRpdGxlIiwiY2FyZEltYWdlIiwidGV4dENvbnRlbnQiLCJzcmMiLCJhbHQiLCJfc2V0RXZlbnRMaXN0ZW5lcnMiLCJfY2hlY2tDYXJkIiwiX2NoZWNrTGlrZSIsImFkZEV2ZW50TGlzdGVuZXIiLCJjbGFzc0xpc3QiLCJhZGQiLCJQb3B1cCIsInBvcHVwU2VsZWN0b3IiLCJfcG9wdXBTZWxlY3RvciIsIl9wb3B1cCIsIl9vcGVuUG9wdXBTZWxlY3RvciIsIl9oYW5kbGVFc2NDbG9zZSIsImJpbmQiLCJldmVudCIsImtleSIsImNsb3NlIiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsInRhcmdldCIsImN1cnJlbnRUYXJnZXQiLCJjb250YWlucyIsIl9oYW5kbGVDbGlja0Nsb3NlIiwiUG9wdXBXaXRoSW1hZ2UiLCJfcG9wdXBJbWFnZSIsIl9wb3B1cEltYWdlQ2FwdGlvbiIsIlBvcHVwV2l0aEZvcm0iLCJoYW5kbGVGb3JtU3VibWl0IiwiX2hhbmRsZVN1Ym1pdEZvcm0iLCJfZm9ybUVsZW1lbnQiLCJfaW5wdXRMaXN0IiwicXVlcnlTZWxlY3RvckFsbCIsIl9zdWJtaXRCdXR0b25FbGVtZW50IiwicmVzZXQiLCJfZm9ybVZhbHVlcyIsImlucHV0IiwidmFsdWUiLCJwcmV2ZW50RGVmYXVsdCIsIl9nZXRJbnB1dFZhbHVlcyIsIlBvcHVwV2l0aENvbmZpcm1hdGlvbiIsIl9oYW5kbGVDbGlja1N1Ym1pdCIsImhhbmRsZXIiLCJVc2VySW5mbyIsIm5hbWVTZWxlY3RvciIsImFib3V0U2VsZWN0b3IiLCJhdmF0YXJTZWxlY3RvciIsIl9uYW1lIiwiX2Fib3V0IiwiX2F2YXRhciIsImFib3V0IiwiYXZhdGFyIiwidXNlckRhdGEiLCJGb3JtVmFsaWRhdG9yIiwiZm9ybUVsZW1lbnQiLCJfaW5wdXRTZWxlY3RvciIsIl9pbnB1dEVycm9yQ2xhc3MiLCJfZXJyb3JTZWxlY3RvciIsIl9lcnJvckNsYXNzIiwiX3N1Ym1pdEJ1dHRvblNlbGVjdG9yIiwiX2luYWN0aXZlQnV0dG9uQ2xhc3MiLCJfYnV0dG9uRWxlbWVudCIsImlucHV0RWxlbWVudCIsIl9pc1ZhbGlkIiwiX3RvZ2dsZUJ1dHRvblN0YXRlIiwidmFsaWRpdHkiLCJ2YWxpZCIsIl9oaWRlSW5wdXRFcnJvciIsIl9zaG93SW5wdXRFcnJvciIsInZhbGlkYXRpb25NZXNzYWdlIiwiZXJyb3JNZXNzYWdlIiwiZXJyb3JFbGVtZW50IiwiaWQiLCJfaGFzSW52YWxpZElucHV0IiwiX2Rpc2FibGVCdXR0b24iLCJfZW5hYmxlQnV0dG9uIiwic29tZSIsInNldEF0dHJpYnV0ZSIsInJlbW92ZUF0dHJpYnV0ZSIsIkFwaSIsIm9wdGlvbnMiLCJfdXJsIiwiYmFzZVVybCIsIl9oZWFkZXJzIiwiaGVhZGVycyIsInJlcyIsImVycm9yVGV4dCIsIm9rIiwianNvbiIsIlByb21pc2UiLCJyZWplY3QiLCJmZXRjaCIsIm1ldGhvZCIsInRoZW4iLCJfaGFuZGxlUmVzcG9uc2UiLCJhbGwiLCJnZXRVc2VySW5mbyIsImdldEluaXRpYWxDYXJkcyIsImJvZHkiLCJKU09OIiwic3RyaW5naWZ5IiwicG9wdXBFbmxhcmdpbmciLCJzZXRFdmVudExpc3RlbmVycyIsInBvcHVwU3VibWl0aW5nIiwiZ2V0U3VibWl0SW5pdGlhbFRleHQiLCJwb3B1cCIsImdldFN1Ym1pdEJ1dHRvbiIsImNoYW5nZVN1Ym1pdFRleHQiLCJzdGFydERvd25sb2FkIiwiaW5pdGlhbFRleHQiLCJ1cGxvYWRUZXh0IiwidXNlckluZm8iLCJhcGkiLCJhdXRob3JpemF0aW9uIiwiZ2V0SW5pdGlhbERhdGEiLCJpbml0aWFsRGF0YSIsImluaXRpYWxDYXJkc0RhdGEiLCJjaGVja0xpa2VDYXJkIiwibGlrZSIsInNldFVzZXJJbmZvIiwiY2FyZExpc3QiLCJyZXZlcnNlIiwiY2FyZEVsZW1lbnQiLCJvcGVuIiwidXBkYXRl0KFvdW50ZXIiLCJjYXJkRGF0YSIsImRlbGV0ZUxpa2UiLCJjYXRjaCIsImVycm9yIiwiY29uc29sZSIsImxvZyIsInNldEhhbmRsZXIiLCJkZWxldGVDYXJkIiwiZmluYWxseSIsImNyZWF0ZUNhcmQiLCJnZW5lcmF0ZUNhcmQiLCJhZGRJdGVtIiwicmVuZGVySXRlbXMiLCJkYXRhT2JqZWN0IiwidmFsaWRhdG9yIiwiZm9ybU5hbWUiLCJnZXRBdHRyaWJ1dGUiLCJlbmFibGVWYWxpZGF0aW9uIiwicG9wdXBFZGl0aW5nIiwiaW5wdXRWYWx1ZXMiLCJlZGl0VXNlckluZm8iLCJzZXRJbnB1dFZhbHVlcyIsInBvcHVwQWRkaW5nIiwicGxhY2UiLCJhZGROZXdDYXJkIiwicmVuZGVyT25lSXRlbSIsInBvcHVwVXBkYXRpbmdBdmF0YXIiLCJ1cGRhdGVBdmF0YXIiXSwic291cmNlUm9vdCI6IiJ9